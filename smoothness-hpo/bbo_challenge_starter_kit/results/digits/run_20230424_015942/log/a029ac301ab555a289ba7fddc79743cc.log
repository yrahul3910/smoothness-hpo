running: {'--uuid': 'a029ac301ab555a289ba7fddc79743cc', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_015942', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d iris -o smoothness -u a029ac301ab555a289ba7fddc79743cc -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_015942
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_iris_nll betwen [1.31057198 1.56976556 1.25224472 0.90978049 0.39813052] and [1.32439241 1.77609477 1.43221076 0.9966468  0.57459871]
  warnings.warn(

Signature errors:
                         0         1         2         3         4       max
MLP-adam_iris_nll  0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
max                0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
starting sklearn study smoothness MLP-adam iris nll 15 1
with data root: None
suggestion time taken 12.123759 iter 0 next_points [{'alpha': 0.0004163999817168882, 'batch_size': 63, 'beta_1': 0.8157724249216075, 'beta_2': 0.9999332587906188, 'epsilon': 1.2023457858754525e-07, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.00012223620726462692, 'tol': 0.00021849984309465467, 'validation_fraction': 0.5904532875869495}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.042502 value 1.500279 suggestion {'alpha': 0.0004163999817168882, 'batch_size': 63, 'beta_1': 0.8157724249216075, 'beta_2': 0.9999332587906188, 'epsilon': 1.2023457858754525e-07, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.00012223620726462692, 'tol': 0.00021849984309465467, 'validation_fraction': 0.5904532875869495}
observation time 0.000006, current best 1.500279 at iter 0
suggestion time taken 12.114054 iter 1 next_points [{'alpha': 1.990646487404905e-05, 'batch_size': 88, 'beta_1': 0.9679700607137686, 'beta_2': 0.988589937653511, 'epsilon': 2.167646855573437e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.000940088549587655, 'tol': 0.044639167682440674, 'validation_fraction': 0.3721590390630777}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.050026 value 1.379774 suggestion {'alpha': 1.990646487404905e-05, 'batch_size': 88, 'beta_1': 0.9679700607137686, 'beta_2': 0.988589937653511, 'epsilon': 2.167646855573437e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.000940088549587655, 'tol': 0.044639167682440674, 'validation_fraction': 0.3721590390630777}
observation time 0.000006, current best 1.379774 at iter 1
suggestion time taken 11.831624 iter 2 next_points [{'alpha': 2.907060998192828e-05, 'batch_size': 69, 'beta_1': 0.8126166033449052, 'beta_2': 0.9999852159559033, 'epsilon': 3.000750251429099e-09, 'hidden_layer_sizes': 123, 'learning_rate_init': 0.020301877653148358, 'tol': 0.006528728891183033, 'validation_fraction': 0.47995605946769987}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.079279 value 0.332646 suggestion {'alpha': 2.907060998192828e-05, 'batch_size': 69, 'beta_1': 0.8126166033449052, 'beta_2': 0.9999852159559033, 'epsilon': 3.000750251429099e-09, 'hidden_layer_sizes': 123, 'learning_rate_init': 0.020301877653148358, 'tol': 0.006528728891183033, 'validation_fraction': 0.47995605946769987}
observation time 0.000006, current best 0.332646 at iter 2
suggestion time taken 12.240007 iter 3 next_points [{'alpha': 0.018366467848301964, 'batch_size': 46, 'beta_1': 0.9384620100182169, 'beta_2': 0.9907232960429349, 'epsilon': 2.110518556651129e-08, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.02668207104311675, 'tol': 0.013259835016825415, 'validation_fraction': 0.7092855136759241}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.085172 value 0.304718 suggestion {'alpha': 0.018366467848301964, 'batch_size': 46, 'beta_1': 0.9384620100182169, 'beta_2': 0.9907232960429349, 'epsilon': 2.110518556651129e-08, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.02668207104311675, 'tol': 0.013259835016825415, 'validation_fraction': 0.7092855136759241}
observation time 0.000005, current best 0.304718 at iter 3
suggestion time taken 11.819775 iter 4 next_points [{'alpha': 1.8694011445465036e-05, 'batch_size': 78, 'beta_1': 0.5046549557774855, 'beta_2': 0.9884574926361914, 'epsilon': 1.0972547300605572e-07, 'hidden_layer_sizes': 75, 'learning_rate_init': 2.4443451282239516e-05, 'tol': 0.007320250905202137, 'validation_fraction': 0.3442027525205265}]
function_evaluation time 0.043082 value 1.558076 suggestion {'alpha': 1.8694011445465036e-05, 'batch_size': 78, 'beta_1': 0.5046549557774855, 'beta_2': 0.9884574926361914, 'epsilon': 1.0972547300605572e-07, 'hidden_layer_sizes': 75, 'learning_rate_init': 2.4443451282239516e-05, 'tol': 0.007320250905202137, 'validation_fraction': 0.3442027525205265}
observation time 0.000006, current best 0.304718 at iter 4
suggestion time taken 12.172998 iter 5 next_points [{'alpha': 0.0009395189345032752, 'batch_size': 72, 'beta_1': 0.874210211437032, 'beta_2': 0.9999721085632949, 'epsilon': 5.962408665996996e-07, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.018518211526254436, 'tol': 0.0021373550749018825, 'validation_fraction': 0.5052371658363092}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.079499 value 0.450285 suggestion {'alpha': 0.0009395189345032752, 'batch_size': 72, 'beta_1': 0.874210211437032, 'beta_2': 0.9999721085632949, 'epsilon': 5.962408665996996e-07, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.018518211526254436, 'tol': 0.0021373550749018825, 'validation_fraction': 0.5052371658363092}
observation time 0.000006, current best 0.304718 at iter 5
suggestion time taken 11.811384 iter 6 next_points [{'alpha': 0.21948858996426163, 'batch_size': 96, 'beta_1': 0.9831813975840159, 'beta_2': 0.9997965478449434, 'epsilon': 7.030094935432592e-07, 'hidden_layer_sizes': 60, 'learning_rate_init': 5.392106295459209e-05, 'tol': 0.0015815090501025844, 'validation_fraction': 0.8911886741830478}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.051808 value 1.753880 suggestion {'alpha': 0.21948858996426163, 'batch_size': 96, 'beta_1': 0.9831813975840159, 'beta_2': 0.9997965478449434, 'epsilon': 7.030094935432592e-07, 'hidden_layer_sizes': 60, 'learning_rate_init': 5.392106295459209e-05, 'tol': 0.0015815090501025844, 'validation_fraction': 0.8911886741830478}
observation time 0.000005, current best 0.304718 at iter 6
suggestion time taken 12.286171 iter 7 next_points [{'alpha': 1.2702186106417421, 'batch_size': 90, 'beta_1': 0.9705718404144362, 'beta_2': 0.9996329063319416, 'epsilon': 1.4967417733613464e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.0004987120802095729, 'tol': 4.196561047638087e-05, 'validation_fraction': 0.8067652309813601}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.054368 value 1.327994 suggestion {'alpha': 1.2702186106417421, 'batch_size': 90, 'beta_1': 0.9705718404144362, 'beta_2': 0.9996329063319416, 'epsilon': 1.4967417733613464e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.0004987120802095729, 'tol': 4.196561047638087e-05, 'validation_fraction': 0.8067652309813601}
observation time 0.000005, current best 0.304718 at iter 7
suggestion time taken 11.724815 iter 8 next_points [{'alpha': 0.01773208762542888, 'batch_size': 45, 'beta_1': 0.9701646844553679, 'beta_2': 0.9998648612042693, 'epsilon': 6.644808630337913e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0024721581921405954, 'tol': 0.020044034940748964, 'validation_fraction': 0.8705955038745021}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.055008 value 0.995073 suggestion {'alpha': 0.01773208762542888, 'batch_size': 45, 'beta_1': 0.9701646844553679, 'beta_2': 0.9998648612042693, 'epsilon': 6.644808630337913e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0024721581921405954, 'tol': 0.020044034940748964, 'validation_fraction': 0.8705955038745021}
observation time 0.000005, current best 0.304718 at iter 8
suggestion time taken 11.931746 iter 9 next_points [{'alpha': 7.046818188287331, 'batch_size': 81, 'beta_1': 0.9260851599633211, 'beta_2': 0.9998884728050632, 'epsilon': 6.627009081978001e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0013306175231447381, 'tol': 0.002589702511995748, 'validation_fraction': 0.19626795090360383}]
function_evaluation time 0.050072 value 2.057206 suggestion {'alpha': 7.046818188287331, 'batch_size': 81, 'beta_1': 0.9260851599633211, 'beta_2': 0.9998884728050632, 'epsilon': 6.627009081978001e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0013306175231447381, 'tol': 0.002589702511995748, 'validation_fraction': 0.19626795090360383}
observation time 0.000005, current best 0.304718 at iter 9
suggestion time taken 11.875106 iter 10 next_points [{'alpha': 4.792646401043822, 'batch_size': 45, 'beta_1': 0.6708273517878693, 'beta_2': 0.9793693881991015, 'epsilon': 6.234355675522086e-08, 'hidden_layer_sizes': 79, 'learning_rate_init': 9.564640174712626e-05, 'tol': 0.0007467361752734251, 'validation_fraction': 0.44202242331060904}]
function_evaluation time 0.062077 value 1.343687 suggestion {'alpha': 4.792646401043822, 'batch_size': 45, 'beta_1': 0.6708273517878693, 'beta_2': 0.9793693881991015, 'epsilon': 6.234355675522086e-08, 'hidden_layer_sizes': 79, 'learning_rate_init': 9.564640174712626e-05, 'tol': 0.0007467361752734251, 'validation_fraction': 0.44202242331060904}
observation time 0.000005, current best 0.304718 at iter 10
suggestion time taken 11.926041 iter 11 next_points [{'alpha': 0.004584704684275414, 'batch_size': 94, 'beta_1': 0.9895826638074504, 'beta_2': 0.9916745341071923, 'epsilon': 5.25488622644322e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.00017508502835446844, 'tol': 0.031417713235779174, 'validation_fraction': 0.8379143948309639}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.044331 value 1.740324 suggestion {'alpha': 0.004584704684275414, 'batch_size': 94, 'beta_1': 0.9895826638074504, 'beta_2': 0.9916745341071923, 'epsilon': 5.25488622644322e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.00017508502835446844, 'tol': 0.031417713235779174, 'validation_fraction': 0.8379143948309639}
observation time 0.000005, current best 0.304718 at iter 11
suggestion time taken 11.667152 iter 12 next_points [{'alpha': 0.11000238898806904, 'batch_size': 71, 'beta_1': 0.5229350466497497, 'beta_2': 0.9993990776242578, 'epsilon': 1.5375058840678985e-07, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.007577589615168158, 'tol': 0.012192178662797341, 'validation_fraction': 0.17536341856118992}]
function_evaluation time 0.097243 value 0.445512 suggestion {'alpha': 0.11000238898806904, 'batch_size': 71, 'beta_1': 0.5229350466497497, 'beta_2': 0.9993990776242578, 'epsilon': 1.5375058840678985e-07, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.007577589615168158, 'tol': 0.012192178662797341, 'validation_fraction': 0.17536341856118992}
observation time 0.000005, current best 0.304718 at iter 12
suggestion time taken 12.172307 iter 13 next_points [{'alpha': 0.7606173368042982, 'batch_size': 73, 'beta_1': 0.947968160998226, 'beta_2': 0.9680539451508416, 'epsilon': 8.8669887364206e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.09078196222470236, 'tol': 0.0007255920173171799, 'validation_fraction': 0.18977728701434057}]
function_evaluation time 0.085765 value 0.429160 suggestion {'alpha': 0.7606173368042982, 'batch_size': 73, 'beta_1': 0.947968160998226, 'beta_2': 0.9680539451508416, 'epsilon': 8.8669887364206e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.09078196222470236, 'tol': 0.0007255920173171799, 'validation_fraction': 0.18977728701434057}
observation time 0.000006, current best 0.304718 at iter 13
suggestion time taken 11.763532 iter 14 next_points [{'alpha': 0.003038126903096529, 'batch_size': 63, 'beta_1': 0.9536509999531664, 'beta_2': 0.9173212941059725, 'epsilon': 7.088509448926216e-09, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.0012073315155723522, 'tol': 0.0020637212777604745, 'validation_fraction': 0.5852976174693532}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.042761 value 1.635864 suggestion {'alpha': 0.003038126903096529, 'batch_size': 63, 'beta_1': 0.9536509999531664, 'beta_2': 0.9173212941059725, 'epsilon': 7.088509448926216e-09, 'hidden_layer_sizes': 59, 'learning_rate_init': 0.0012073315155723522, 'tol': 0.0020637212777604745, 'validation_fraction': 0.5852976174693532}
observation time 0.000005, current best 0.304718 at iter 14
saving meta data: {'args': {'--uuid': 'a029ac301ab555a289ba7fddc79743cc', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_015942', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])}
saving results
saving timing
saving suggest log
done
