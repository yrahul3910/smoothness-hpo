running: {'--uuid': 'ea4f06949cfe548b87f2f77adadc45f7', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_015942', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d iris -o smoothness -u ea4f06949cfe548b87f2f77adadc45f7 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_015942
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_iris_nll betwen [1.31057198 1.56976556 1.25224472 0.90978049 0.39813052] and [1.32439241 1.77609477 1.43221076 0.9966468  0.57459871]
  warnings.warn(

Signature errors:
                         0         1         2         3         4       max
MLP-adam_iris_nll  0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
max                0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
starting sklearn study smoothness MLP-adam iris nll 15 1
with data root: None
suggestion time taken 12.022880 iter 0 next_points [{'alpha': 9.952468635077773, 'batch_size': 103, 'beta_1': 0.6768467368751161, 'beta_2': 0.9685268709253221, 'epsilon': 3.7780768150296293e-08, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.001206104814156131, 'tol': 0.0017506633844890532, 'validation_fraction': 0.19144808289099297}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.053574 value 1.351412 suggestion {'alpha': 9.952468635077773, 'batch_size': 103, 'beta_1': 0.6768467368751161, 'beta_2': 0.9685268709253221, 'epsilon': 3.7780768150296293e-08, 'hidden_layer_sizes': 80, 'learning_rate_init': 0.001206104814156131, 'tol': 0.0017506633844890532, 'validation_fraction': 0.19144808289099297}
observation time 0.000006, current best 1.351412 at iter 0
suggestion time taken 12.114754 iter 1 next_points [{'alpha': 0.09665680367900949, 'batch_size': 57, 'beta_1': 0.9806473967575506, 'beta_2': 0.9999837869031091, 'epsilon': 1.2460315874256754e-07, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.0003911042446814503, 'tol': 0.00019981981239297408, 'validation_fraction': 0.17713655359150304}]
function_evaluation time 0.073778 value 1.414937 suggestion {'alpha': 0.09665680367900949, 'batch_size': 57, 'beta_1': 0.9806473967575506, 'beta_2': 0.9999837869031091, 'epsilon': 1.2460315874256754e-07, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.0003911042446814503, 'tol': 0.00019981981239297408, 'validation_fraction': 0.17713655359150304}
observation time 0.000006, current best 1.351412 at iter 1
suggestion time taken 11.597396 iter 2 next_points [{'alpha': 0.04077728070491217, 'batch_size': 58, 'beta_1': 0.9651037756121471, 'beta_2': 0.9999824216396993, 'epsilon': 7.712274882409473e-07, 'hidden_layer_sizes': 100, 'learning_rate_init': 7.179549189862032e-05, 'tol': 0.00016209922460283058, 'validation_fraction': 0.415747879091138}]
function_evaluation time 0.060589 value 1.318311 suggestion {'alpha': 0.04077728070491217, 'batch_size': 58, 'beta_1': 0.9651037756121471, 'beta_2': 0.9999824216396993, 'epsilon': 7.712274882409473e-07, 'hidden_layer_sizes': 100, 'learning_rate_init': 7.179549189862032e-05, 'tol': 0.00016209922460283058, 'validation_fraction': 0.415747879091138}
observation time 0.000006, current best 1.318311 at iter 2
suggestion time taken 12.375391 iter 3 next_points [{'alpha': 0.0004683544655250262, 'batch_size': 142, 'beta_1': 0.9793934735332328, 'beta_2': 0.9446661956242224, 'epsilon': 4.1675204976260773e-07, 'hidden_layer_sizes': 53, 'learning_rate_init': 5.670861714528507e-05, 'tol': 4.7009554691667845e-05, 'validation_fraction': 0.7911581842464965}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.043465 value 1.229545 suggestion {'alpha': 0.0004683544655250262, 'batch_size': 142, 'beta_1': 0.9793934735332328, 'beta_2': 0.9446661956242224, 'epsilon': 4.1675204976260773e-07, 'hidden_layer_sizes': 53, 'learning_rate_init': 5.670861714528507e-05, 'tol': 4.7009554691667845e-05, 'validation_fraction': 0.7911581842464965}
observation time 0.000007, current best 1.229545 at iter 3
suggestion time taken 11.888056 iter 4 next_points [{'alpha': 0.000785992954196368, 'batch_size': 72, 'beta_1': 0.946788915872317, 'beta_2': 0.9998182625374912, 'epsilon': 1.9281777538326363e-09, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0007720945337037254, 'tol': 1.5171123557683552e-05, 'validation_fraction': 0.11201064236769623}]
function_evaluation time 0.080960 value 0.991405 suggestion {'alpha': 0.000785992954196368, 'batch_size': 72, 'beta_1': 0.946788915872317, 'beta_2': 0.9998182625374912, 'epsilon': 1.9281777538326363e-09, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0007720945337037254, 'tol': 1.5171123557683552e-05, 'validation_fraction': 0.11201064236769623}
observation time 0.000005, current best 0.991405 at iter 4
suggestion time taken 12.104836 iter 5 next_points [{'alpha': 8.944379307813348e-05, 'batch_size': 77, 'beta_1': 0.873573951334679, 'beta_2': 0.9341239972620237, 'epsilon': 6.193439097969391e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 2.9102305475164292e-05, 'tol': 0.0007531354627160719, 'validation_fraction': 0.7424422223813645}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.051243 value 1.840887 suggestion {'alpha': 8.944379307813348e-05, 'batch_size': 77, 'beta_1': 0.873573951334679, 'beta_2': 0.9341239972620237, 'epsilon': 6.193439097969391e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 2.9102305475164292e-05, 'tol': 0.0007531354627160719, 'validation_fraction': 0.7424422223813645}
observation time 0.000005, current best 0.991405 at iter 5
suggestion time taken 12.017484 iter 6 next_points [{'alpha': 0.0014902558468209363, 'batch_size': 60, 'beta_1': 0.988544096587401, 'beta_2': 0.999588857874524, 'epsilon': 7.928835616530112e-08, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.005661898290633441, 'tol': 0.015363642800053989, 'validation_fraction': 0.3697326317552139}]
function_evaluation time 0.091498 value 0.603250 suggestion {'alpha': 0.0014902558468209363, 'batch_size': 60, 'beta_1': 0.988544096587401, 'beta_2': 0.999588857874524, 'epsilon': 7.928835616530112e-08, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.005661898290633441, 'tol': 0.015363642800053989, 'validation_fraction': 0.3697326317552139}
observation time 0.000006, current best 0.603250 at iter 6
suggestion time taken 12.372485 iter 7 next_points [{'alpha': 0.002873509976746234, 'batch_size': 41, 'beta_1': 0.9365707124145332, 'beta_2': 0.9999539348468149, 'epsilon': 3.0526264238916588e-09, 'hidden_layer_sizes': 82, 'learning_rate_init': 0.01334063307698815, 'tol': 1.738942157746903e-05, 'validation_fraction': 0.6989219231585798}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.072421 value 0.454054 suggestion {'alpha': 0.002873509976746234, 'batch_size': 41, 'beta_1': 0.9365707124145332, 'beta_2': 0.9999539348468149, 'epsilon': 3.0526264238916588e-09, 'hidden_layer_sizes': 82, 'learning_rate_init': 0.01334063307698815, 'tol': 1.738942157746903e-05, 'validation_fraction': 0.6989219231585798}
observation time 0.000006, current best 0.454054 at iter 7
suggestion time taken 11.951048 iter 8 next_points [{'alpha': 0.0001883738312565232, 'batch_size': 194, 'beta_1': 0.724115373835985, 'beta_2': 0.9999580567044208, 'epsilon': 5.383360264360049e-09, 'hidden_layer_sizes': 50, 'learning_rate_init': 7.38495103001671e-05, 'tol': 6.122978576313395e-05, 'validation_fraction': 0.35108604716458247}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.044397 value 1.682847 suggestion {'alpha': 0.0001883738312565232, 'batch_size': 194, 'beta_1': 0.724115373835985, 'beta_2': 0.9999580567044208, 'epsilon': 5.383360264360049e-09, 'hidden_layer_sizes': 50, 'learning_rate_init': 7.38495103001671e-05, 'tol': 6.122978576313395e-05, 'validation_fraction': 0.35108604716458247}
observation time 0.000006, current best 0.454054 at iter 8
suggestion time taken 11.985154 iter 9 next_points [{'alpha': 0.0015972382229271715, 'batch_size': 56, 'beta_1': 0.7079240876970311, 'beta_2': 0.9064230891923196, 'epsilon': 5.226435044011061e-09, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.008953272092741046, 'tol': 0.00017370699564206205, 'validation_fraction': 0.7947926268422407}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.074072 value 0.512521 suggestion {'alpha': 0.0015972382229271715, 'batch_size': 56, 'beta_1': 0.7079240876970311, 'beta_2': 0.9064230891923196, 'epsilon': 5.226435044011061e-09, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.008953272092741046, 'tol': 0.00017370699564206205, 'validation_fraction': 0.7947926268422407}
observation time 0.000006, current best 0.454054 at iter 9
suggestion time taken 12.545616 iter 10 next_points [{'alpha': 0.0022488365643497377, 'batch_size': 81, 'beta_1': 0.9177520926640843, 'beta_2': 0.9996501427702593, 'epsilon': 2.0607724667576534e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.00019101868248264195, 'tol': 0.0040865815477661, 'validation_fraction': 0.15997989667759813}]
function_evaluation time 0.045743 value 1.853589 suggestion {'alpha': 0.0022488365643497377, 'batch_size': 81, 'beta_1': 0.9177520926640843, 'beta_2': 0.9996501427702593, 'epsilon': 2.0607724667576534e-07, 'hidden_layer_sizes': 56, 'learning_rate_init': 0.00019101868248264195, 'tol': 0.0040865815477661, 'validation_fraction': 0.15997989667759813}
observation time 0.000006, current best 0.454054 at iter 10
suggestion time taken 12.075368 iter 11 next_points [{'alpha': 0.13016180645969633, 'batch_size': 88, 'beta_1': 0.97020539260414, 'beta_2': 0.999957325978441, 'epsilon': 8.771274555388655e-09, 'hidden_layer_sizes': 99, 'learning_rate_init': 4.2040773949897806e-05, 'tol': 0.06889148177762788, 'validation_fraction': 0.41395335902494806}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.045939 value 1.494369 suggestion {'alpha': 0.13016180645969633, 'batch_size': 88, 'beta_1': 0.97020539260414, 'beta_2': 0.999957325978441, 'epsilon': 8.771274555388655e-09, 'hidden_layer_sizes': 99, 'learning_rate_init': 4.2040773949897806e-05, 'tol': 0.06889148177762788, 'validation_fraction': 0.41395335902494806}
observation time 0.000006, current best 0.454054 at iter 11
suggestion time taken 12.067824 iter 12 next_points [{'alpha': 3.4767105250467685e-05, 'batch_size': 103, 'beta_1': 0.9807594813771889, 'beta_2': 0.999907802859033, 'epsilon': 2.3820436279338733e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0005710648718810253, 'tol': 1.089031998228155e-05, 'validation_fraction': 0.2758518140190827}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.045466 value 1.689383 suggestion {'alpha': 3.4767105250467685e-05, 'batch_size': 103, 'beta_1': 0.9807594813771889, 'beta_2': 0.999907802859033, 'epsilon': 2.3820436279338733e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0005710648718810253, 'tol': 1.089031998228155e-05, 'validation_fraction': 0.2758518140190827}
observation time 0.000006, current best 0.454054 at iter 12
suggestion time taken 12.730179 iter 13 next_points [{'alpha': 0.14096644291487148, 'batch_size': 51, 'beta_1': 0.9891879789875279, 'beta_2': 0.9992637769955319, 'epsilon': 1.1770426769747844e-09, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0008767905285938545, 'tol': 0.07728255383925205, 'validation_fraction': 0.11605741542711051}]
function_evaluation time 0.086455 value 1.339769 suggestion {'alpha': 0.14096644291487148, 'batch_size': 51, 'beta_1': 0.9891879789875279, 'beta_2': 0.9992637769955319, 'epsilon': 1.1770426769747844e-09, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.0008767905285938545, 'tol': 0.07728255383925205, 'validation_fraction': 0.11605741542711051}
observation time 0.000006, current best 0.454054 at iter 13
suggestion time taken 12.336007 iter 14 next_points [{'alpha': 8.710326297923567, 'batch_size': 82, 'beta_1': 0.8351188674322889, 'beta_2': 0.9776214893112198, 'epsilon': 5.858229049209922e-09, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.01984318991875402, 'tol': 0.0005022387371976284, 'validation_fraction': 0.5446681000759924}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.081120 value 0.543902 suggestion {'alpha': 8.710326297923567, 'batch_size': 82, 'beta_1': 0.8351188674322889, 'beta_2': 0.9776214893112198, 'epsilon': 5.858229049209922e-09, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.01984318991875402, 'tol': 0.0005022387371976284, 'validation_fraction': 0.5446681000759924}
observation time 0.000006, current best 0.454054 at iter 14
saving meta data: {'args': {'--uuid': 'ea4f06949cfe548b87f2f77adadc45f7', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_015942', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])}
saving results
saving timing
saving suggest log
done
