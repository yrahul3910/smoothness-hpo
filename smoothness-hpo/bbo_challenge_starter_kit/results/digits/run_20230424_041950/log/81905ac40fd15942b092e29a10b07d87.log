running: {'--uuid': '81905ac40fd15942b092e29a10b07d87', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u 81905ac40fd15942b092e29a10b07d87 -m acc -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_041950
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_acc betwen [-0.2181506  -0.12954897 -0.42701514 -0.94997127 -0.93320509] and [-0.21081107 -0.11575494 -0.27999177 -0.94225223 -0.93253861]
  warnings.warn(

Signature errors:
                           0         1         2         3         4       max
MLP-adam_digits_acc  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
max                  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
starting sklearn study smoothness MLP-adam digits acc 15 1
with data root: None
suggestion time taken 11.990171 iter 0 next_points [{'alpha': 0.0001641990678833217, 'batch_size': 81, 'beta_1': 0.7439979970217347, 'beta_2': 0.9169388480890172, 'epsilon': 1.075680411565478e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.005042173314619484, 'tol': 0.0005462068289259106, 'validation_fraction': 0.13935981675542225}]
function_evaluation time 0.805572 value -0.974257 suggestion {'alpha': 0.0001641990678833217, 'batch_size': 81, 'beta_1': 0.7439979970217347, 'beta_2': 0.9169388480890172, 'epsilon': 1.075680411565478e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.005042173314619484, 'tol': 0.0005462068289259106, 'validation_fraction': 0.13935981675542225}
observation time 0.000006, current best -0.974257 at iter 0
suggestion time taken 12.374846 iter 1 next_points [{'alpha': 3.374408133254379, 'batch_size': 95, 'beta_1': 0.8056808751429715, 'beta_2': 0.9970130140362189, 'epsilon': 3.461609433505578e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.002221608438778737, 'tol': 0.010541258755957272, 'validation_fraction': 0.27709803656425}]
function_evaluation time 0.653495 value -0.951302 suggestion {'alpha': 3.374408133254379, 'batch_size': 95, 'beta_1': 0.8056808751429715, 'beta_2': 0.9970130140362189, 'epsilon': 3.461609433505578e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.002221608438778737, 'tol': 0.010541258755957272, 'validation_fraction': 0.27709803656425}
observation time 0.000007, current best -0.974257 at iter 1
suggestion time taken 11.776069 iter 2 next_points [{'alpha': 1.2857740949913627e-05, 'batch_size': 102, 'beta_1': 0.8826657523931201, 'beta_2': 0.9999665140798097, 'epsilon': 6.114730385191795e-07, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.04595631813489243, 'tol': 0.011158748628953852, 'validation_fraction': 0.1011339583833766}]
function_evaluation time 1.003267 value -0.875566 suggestion {'alpha': 1.2857740949913627e-05, 'batch_size': 102, 'beta_1': 0.8826657523931201, 'beta_2': 0.9999665140798097, 'epsilon': 6.114730385191795e-07, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.04595631813489243, 'tol': 0.011158748628953852, 'validation_fraction': 0.1011339583833766}
observation time 0.000005, current best -0.974257 at iter 2
suggestion time taken 11.668546 iter 3 next_points [{'alpha': 0.006808156282561576, 'batch_size': 179, 'beta_1': 0.7922976170491929, 'beta_2': 0.9797231073872662, 'epsilon': 1.973267617717301e-08, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.0015620243334267543, 'tol': 0.0003347023993695043, 'validation_fraction': 0.6939462893834419}]
function_evaluation time 1.539323 value -0.917192 suggestion {'alpha': 0.006808156282561576, 'batch_size': 179, 'beta_1': 0.7922976170491929, 'beta_2': 0.9797231073872662, 'epsilon': 1.973267617717301e-08, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.0015620243334267543, 'tol': 0.0003347023993695043, 'validation_fraction': 0.6939462893834419}
observation time 0.000005, current best -0.974257 at iter 3
suggestion time taken 11.745326 iter 4 next_points [{'alpha': 0.0005938175459158177, 'batch_size': 27, 'beta_1': 0.8923006702553651, 'beta_2': 0.9999738975355675, 'epsilon': 1.5337575130646994e-09, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.03307045600080583, 'tol': 2.4346615868814856e-05, 'validation_fraction': 0.8225263350840812}]
function_evaluation time 0.738831 value -0.903976 suggestion {'alpha': 0.0005938175459158177, 'batch_size': 27, 'beta_1': 0.8923006702553651, 'beta_2': 0.9999738975355675, 'epsilon': 1.5337575130646994e-09, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.03307045600080583, 'tol': 2.4346615868814856e-05, 'validation_fraction': 0.8225263350840812}
observation time 0.000005, current best -0.974257 at iter 4
suggestion time taken 11.903624 iter 5 next_points [{'alpha': 0.2986596100382159, 'batch_size': 135, 'beta_1': 0.6847952694295172, 'beta_2': 0.9022462107645507, 'epsilon': 5.57331932933826e-07, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.0002880989478420809, 'tol': 2.0419378404975413e-05, 'validation_fraction': 0.8888530128547155}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 1.439489 value -0.573473 suggestion {'alpha': 0.2986596100382159, 'batch_size': 135, 'beta_1': 0.6847952694295172, 'beta_2': 0.9022462107645507, 'epsilon': 5.57331932933826e-07, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.0002880989478420809, 'tol': 2.0419378404975413e-05, 'validation_fraction': 0.8888530128547155}
observation time 0.000005, current best -0.974257 at iter 5
suggestion time taken 12.209379 iter 6 next_points [{'alpha': 0.04411421608119378, 'batch_size': 46, 'beta_1': 0.976895836396471, 'beta_2': 0.9997637604701813, 'epsilon': 1.236275842044523e-07, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.0033546135364059307, 'tol': 0.009618391972107718, 'validation_fraction': 0.7970514314123528}]
function_evaluation time 0.476099 value -0.885204 suggestion {'alpha': 0.04411421608119378, 'batch_size': 46, 'beta_1': 0.976895836396471, 'beta_2': 0.9997637604701813, 'epsilon': 1.236275842044523e-07, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.0033546135364059307, 'tol': 0.009618391972107718, 'validation_fraction': 0.7970514314123528}
observation time 0.000005, current best -0.974257 at iter 6
suggestion time taken 11.699254 iter 7 next_points [{'alpha': 7.913910710899114e-05, 'batch_size': 61, 'beta_1': 0.8292226333546948, 'beta_2': 0.9997914223312054, 'epsilon': 2.7884896227007716e-08, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.00021549853804449958, 'tol': 7.573100812937625e-05, 'validation_fraction': 0.6133211334207385}]
function_evaluation time 3.587044 value -0.910247 suggestion {'alpha': 7.913910710899114e-05, 'batch_size': 61, 'beta_1': 0.8292226333546948, 'beta_2': 0.9997914223312054, 'epsilon': 2.7884896227007716e-08, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.00021549853804449958, 'tol': 7.573100812937625e-05, 'validation_fraction': 0.6133211334207385}
observation time 0.000005, current best -0.974257 at iter 7
suggestion time taken 11.874143 iter 8 next_points [{'alpha': 2.304044747445465, 'batch_size': 40, 'beta_1': 0.7918912539253748, 'beta_2': 0.9965000826195806, 'epsilon': 6.810617462660424e-07, 'hidden_layer_sizes': 135, 'learning_rate_init': 0.000607332509181374, 'tol': 0.00018927774725651812, 'validation_fraction': 0.772704308678671}]
function_evaluation time 2.358970 value -0.927640 suggestion {'alpha': 2.304044747445465, 'batch_size': 40, 'beta_1': 0.7918912539253748, 'beta_2': 0.9965000826195806, 'epsilon': 6.810617462660424e-07, 'hidden_layer_sizes': 135, 'learning_rate_init': 0.000607332509181374, 'tol': 0.00018927774725651812, 'validation_fraction': 0.772704308678671}
observation time 0.000006, current best -0.974257 at iter 8
suggestion time taken 11.956784 iter 9 next_points [{'alpha': 2.9828387530675603e-05, 'batch_size': 43, 'beta_1': 0.9778437413640257, 'beta_2': 0.9980838415598599, 'epsilon': 9.32938618576213e-09, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.001068092738250226, 'tol': 7.130224725015297e-05, 'validation_fraction': 0.24917812419142202}]
function_evaluation time 1.793759 value -0.954080 suggestion {'alpha': 2.9828387530675603e-05, 'batch_size': 43, 'beta_1': 0.9778437413640257, 'beta_2': 0.9980838415598599, 'epsilon': 9.32938618576213e-09, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.001068092738250226, 'tol': 7.130224725015297e-05, 'validation_fraction': 0.24917812419142202}
observation time 0.000005, current best -0.974257 at iter 9
suggestion time taken 11.779279 iter 10 next_points [{'alpha': 0.0532664867028969, 'batch_size': 104, 'beta_1': 0.7237874014521359, 'beta_2': 0.9999982716889807, 'epsilon': 1.0267866424738509e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.012509232279726496, 'tol': 1.078743696580682e-05, 'validation_fraction': 0.6760743369387081}]
function_evaluation time 1.075504 value -0.932501 suggestion {'alpha': 0.0532664867028969, 'batch_size': 104, 'beta_1': 0.7237874014521359, 'beta_2': 0.9999982716889807, 'epsilon': 1.0267866424738509e-08, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.012509232279726496, 'tol': 1.078743696580682e-05, 'validation_fraction': 0.6760743369387081}
observation time 0.000005, current best -0.974257 at iter 10
suggestion time taken 12.019309 iter 11 next_points [{'alpha': 2.983886672835631, 'batch_size': 85, 'beta_1': 0.9693054680012365, 'beta_2': 0.9865339333264578, 'epsilon': 7.356099316102995e-07, 'hidden_layer_sizes': 55, 'learning_rate_init': 3.678704896123523e-05, 'tol': 0.00017697904566435678, 'validation_fraction': 0.28126332371159446}]
function_evaluation time 4.945698 value -0.732378 suggestion {'alpha': 2.983886672835631, 'batch_size': 85, 'beta_1': 0.9693054680012365, 'beta_2': 0.9865339333264578, 'epsilon': 7.356099316102995e-07, 'hidden_layer_sizes': 55, 'learning_rate_init': 3.678704896123523e-05, 'tol': 0.00017697904566435678, 'validation_fraction': 0.28126332371159446}
observation time 0.000005, current best -0.974257 at iter 11
suggestion time taken 11.870516 iter 12 next_points [{'alpha': 0.0008801760407963979, 'batch_size': 82, 'beta_1': 0.6063988232745683, 'beta_2': 0.9999945601664807, 'epsilon': 4.397608572895195e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.00018490450866645025, 'tol': 0.0006608528344789361, 'validation_fraction': 0.8872849860072421}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 1.279292 value -0.349238 suggestion {'alpha': 0.0008801760407963979, 'batch_size': 82, 'beta_1': 0.6063988232745683, 'beta_2': 0.9999945601664807, 'epsilon': 4.397608572895195e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.00018490450866645025, 'tol': 0.0006608528344789361, 'validation_fraction': 0.8872849860072421}
observation time 0.000005, current best -0.974257 at iter 12
suggestion time taken 11.866481 iter 13 next_points [{'alpha': 7.660834620290419e-05, 'batch_size': 51, 'beta_1': 0.9872016619768141, 'beta_2': 0.9999970719760269, 'epsilon': 9.558842798671614e-08, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.000449709637057383, 'tol': 0.0008708277602860186, 'validation_fraction': 0.5879919172728082}]
function_evaluation time 2.501606 value -0.921397 suggestion {'alpha': 7.660834620290419e-05, 'batch_size': 51, 'beta_1': 0.9872016619768141, 'beta_2': 0.9999970719760269, 'epsilon': 9.558842798671614e-08, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.000449709637057383, 'tol': 0.0008708277602860186, 'validation_fraction': 0.5879919172728082}
observation time 0.000006, current best -0.974257 at iter 13
suggestion time taken 11.498856 iter 14 next_points [{'alpha': 0.008120725786521146, 'batch_size': 105, 'beta_1': 0.7261616361443585, 'beta_2': 0.9999979908021407, 'epsilon': 5.178417256721942e-07, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.008075719084339652, 'tol': 0.00010833882267679837, 'validation_fraction': 0.12729823249690203}]
function_evaluation time 0.719114 value -0.960327 suggestion {'alpha': 0.008120725786521146, 'batch_size': 105, 'beta_1': 0.7261616361443585, 'beta_2': 0.9999979908021407, 'epsilon': 5.178417256721942e-07, 'hidden_layer_sizes': 66, 'learning_rate_init': 0.008075719084339652, 'tol': 0.00010833882267679837, 'validation_fraction': 0.12729823249690203}
observation time 0.000005, current best -0.974257 at iter 14
saving meta data: {'args': {'--uuid': '81905ac40fd15942b092e29a10b07d87', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])}
saving results
saving timing
saving suggest log
done
