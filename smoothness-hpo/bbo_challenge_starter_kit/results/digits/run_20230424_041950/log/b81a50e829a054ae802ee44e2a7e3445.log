running: {'--uuid': 'b81a50e829a054ae802ee44e2a7e3445', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u b81a50e829a054ae802ee44e2a7e3445 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_041950
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study smoothness MLP-adam digits nll 15 1
with data root: None
suggestion time taken 11.964224 iter 0 next_points [{'alpha': 5.297218544300266e-05, 'batch_size': 37, 'beta_1': 0.6883223509457156, 'beta_2': 0.9999957999582961, 'epsilon': 4.987845621793671e-07, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.035974199749205876, 'tol': 0.0341635254356402, 'validation_fraction': 0.11149590735514507}]
function_evaluation time 0.801255 value 0.267809 suggestion {'alpha': 5.297218544300266e-05, 'batch_size': 37, 'beta_1': 0.6883223509457156, 'beta_2': 0.9999957999582961, 'epsilon': 4.987845621793671e-07, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.035974199749205876, 'tol': 0.0341635254356402, 'validation_fraction': 0.11149590735514507}
observation time 0.000007, current best 0.267809 at iter 0
suggestion time taken 11.560204 iter 1 next_points [{'alpha': 0.012663871998954279, 'batch_size': 114, 'beta_1': 0.5886862054402193, 'beta_2': 0.9999916717811785, 'epsilon': 3.1256941127500443e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.00043319340475494143, 'tol': 0.00015143379224088756, 'validation_fraction': 0.45723703989753506}]
function_evaluation time 2.521785 value 0.259558 suggestion {'alpha': 0.012663871998954279, 'batch_size': 114, 'beta_1': 0.5886862054402193, 'beta_2': 0.9999916717811785, 'epsilon': 3.1256941127500443e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.00043319340475494143, 'tol': 0.00015143379224088756, 'validation_fraction': 0.45723703989753506}
observation time 0.000006, current best 0.259558 at iter 1
suggestion time taken 12.014762 iter 2 next_points [{'alpha': 4.081530413801233e-05, 'batch_size': 76, 'beta_1': 0.9425310425171392, 'beta_2': 0.9999918153491971, 'epsilon': 4.8034559846596204e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.00028304266180385364, 'tol': 5.858394527656233e-05, 'validation_fraction': 0.6461054027585733}]
function_evaluation time 2.891807 value 0.268954 suggestion {'alpha': 4.081530413801233e-05, 'batch_size': 76, 'beta_1': 0.9425310425171392, 'beta_2': 0.9999918153491971, 'epsilon': 4.8034559846596204e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.00028304266180385364, 'tol': 5.858394527656233e-05, 'validation_fraction': 0.6461054027585733}
observation time 0.000006, current best 0.259558 at iter 2
suggestion time taken 11.818237 iter 3 next_points [{'alpha': 0.4601413143725502, 'batch_size': 56, 'beta_1': 0.8618242177437102, 'beta_2': 0.9942182061395108, 'epsilon': 2.740122084150924e-09, 'hidden_layer_sizes': 102, 'learning_rate_init': 0.0006317918170483282, 'tol': 0.0005536851292046568, 'validation_fraction': 0.5601335110067688}]
function_evaluation time 2.617131 value 0.165968 suggestion {'alpha': 0.4601413143725502, 'batch_size': 56, 'beta_1': 0.8618242177437102, 'beta_2': 0.9942182061395108, 'epsilon': 2.740122084150924e-09, 'hidden_layer_sizes': 102, 'learning_rate_init': 0.0006317918170483282, 'tol': 0.0005536851292046568, 'validation_fraction': 0.5601335110067688}
observation time 0.000006, current best 0.165968 at iter 3
suggestion time taken 11.451492 iter 4 next_points [{'alpha': 0.9831971298245293, 'batch_size': 72, 'beta_1': 0.9623273421593495, 'beta_2': 0.9999404530194563, 'epsilon': 1.1592960934054414e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 1.0696207414460158e-05, 'tol': 0.0030620099704116535, 'validation_fraction': 0.7199161496745371}]
function_evaluation time 0.217931 value 10.954543 suggestion {'alpha': 0.9831971298245293, 'batch_size': 72, 'beta_1': 0.9623273421593495, 'beta_2': 0.9999404530194563, 'epsilon': 1.1592960934054414e-08, 'hidden_layer_sizes': 56, 'learning_rate_init': 1.0696207414460158e-05, 'tol': 0.0030620099704116535, 'validation_fraction': 0.7199161496745371}
observation time 0.000005, current best 0.165968 at iter 4
suggestion time taken 11.947188 iter 5 next_points [{'alpha': 0.00018285419051147116, 'batch_size': 109, 'beta_1': 0.6437692623425568, 'beta_2': 0.999947355635283, 'epsilon': 9.949277892937617e-07, 'hidden_layer_sizes': 65, 'learning_rate_init': 0.00016011994051950347, 'tol': 0.004234002156659007, 'validation_fraction': 0.1694907987398436}]
function_evaluation time 2.262381 value 0.297811 suggestion {'alpha': 0.00018285419051147116, 'batch_size': 109, 'beta_1': 0.6437692623425568, 'beta_2': 0.999947355635283, 'epsilon': 9.949277892937617e-07, 'hidden_layer_sizes': 65, 'learning_rate_init': 0.00016011994051950347, 'tol': 0.004234002156659007, 'validation_fraction': 0.1694907987398436}
observation time 0.000006, current best 0.165968 at iter 5
suggestion time taken 11.812711 iter 6 next_points [{'alpha': 0.02103631893969199, 'batch_size': 76, 'beta_1': 0.9517430682102876, 'beta_2': 0.9999988791975022, 'epsilon': 1.1740292184514266e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.000553776104814555, 'tol': 5.900672647752757e-05, 'validation_fraction': 0.1910175461444288}]
function_evaluation time 1.576095 value 0.184934 suggestion {'alpha': 0.02103631893969199, 'batch_size': 76, 'beta_1': 0.9517430682102876, 'beta_2': 0.9999988791975022, 'epsilon': 1.1740292184514266e-08, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.000553776104814555, 'tol': 5.900672647752757e-05, 'validation_fraction': 0.1910175461444288}
observation time 0.000005, current best 0.165968 at iter 6
suggestion time taken 11.716449 iter 7 next_points [{'alpha': 1.5694580215914888, 'batch_size': 48, 'beta_1': 0.8273337370854583, 'beta_2': 0.9279633077248342, 'epsilon': 6.60324602724305e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.0005763857101590587, 'tol': 0.008958239820251747, 'validation_fraction': 0.6723104290508364}]
function_evaluation time 0.817431 value 0.269249 suggestion {'alpha': 1.5694580215914888, 'batch_size': 48, 'beta_1': 0.8273337370854583, 'beta_2': 0.9279633077248342, 'epsilon': 6.60324602724305e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.0005763857101590587, 'tol': 0.008958239820251747, 'validation_fraction': 0.6723104290508364}
observation time 0.000005, current best 0.165968 at iter 7
suggestion time taken 11.904883 iter 8 next_points [{'alpha': 9.229463894931891, 'batch_size': 31, 'beta_1': 0.6728966681417488, 'beta_2': 0.9829910473955268, 'epsilon': 3.3825516678520252e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.004107764794400863, 'tol': 0.003374863398693165, 'validation_fraction': 0.14660174572904264}]
function_evaluation time 1.193471 value 0.345958 suggestion {'alpha': 9.229463894931891, 'batch_size': 31, 'beta_1': 0.6728966681417488, 'beta_2': 0.9829910473955268, 'epsilon': 3.3825516678520252e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.004107764794400863, 'tol': 0.003374863398693165, 'validation_fraction': 0.14660174572904264}
observation time 0.000005, current best 0.165968 at iter 8
suggestion time taken 11.647694 iter 9 next_points [{'alpha': 0.6342257699409004, 'batch_size': 72, 'beta_1': 0.6763892781064627, 'beta_2': 0.9999981092696073, 'epsilon': 3.978064169869696e-09, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.009746699704780327, 'tol': 7.484153032419421e-05, 'validation_fraction': 0.20124360951627213}]
function_evaluation time 1.164092 value 0.107274 suggestion {'alpha': 0.6342257699409004, 'batch_size': 72, 'beta_1': 0.6763892781064627, 'beta_2': 0.9999981092696073, 'epsilon': 3.978064169869696e-09, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.009746699704780327, 'tol': 7.484153032419421e-05, 'validation_fraction': 0.20124360951627213}
observation time 0.000005, current best 0.107274 at iter 9
suggestion time taken 12.067613 iter 10 next_points [{'alpha': 1.337743969557169e-05, 'batch_size': 28, 'beta_1': 0.8349662268733166, 'beta_2': 0.9763889698685485, 'epsilon': 4.1116157612931386e-07, 'hidden_layer_sizes': 50, 'learning_rate_init': 0.0005740019017859691, 'tol': 0.02284192075685454, 'validation_fraction': 0.7000478323591034}]
function_evaluation time 0.667685 value 0.433809 suggestion {'alpha': 1.337743969557169e-05, 'batch_size': 28, 'beta_1': 0.8349662268733166, 'beta_2': 0.9763889698685485, 'epsilon': 4.1116157612931386e-07, 'hidden_layer_sizes': 50, 'learning_rate_init': 0.0005740019017859691, 'tol': 0.02284192075685454, 'validation_fraction': 0.7000478323591034}
observation time 0.000005, current best 0.107274 at iter 10
suggestion time taken 12.129714 iter 11 next_points [{'alpha': 5.874146023224116e-05, 'batch_size': 91, 'beta_1': 0.9436633665831473, 'beta_2': 0.9999974670191571, 'epsilon': 9.839605209769366e-07, 'hidden_layer_sizes': 79, 'learning_rate_init': 0.003109724773269148, 'tol': 0.015751946716067413, 'validation_fraction': 0.742301326460578}]
function_evaluation time 0.418646 value 0.330519 suggestion {'alpha': 5.874146023224116e-05, 'batch_size': 91, 'beta_1': 0.9436633665831473, 'beta_2': 0.9999974670191571, 'epsilon': 9.839605209769366e-07, 'hidden_layer_sizes': 79, 'learning_rate_init': 0.003109724773269148, 'tol': 0.015751946716067413, 'validation_fraction': 0.742301326460578}
observation time 0.000005, current best 0.107274 at iter 11
suggestion time taken 11.698208 iter 12 next_points [{'alpha': 0.001150633849704901, 'batch_size': 61, 'beta_1': 0.9281216925966311, 'beta_2': 0.9999987559526793, 'epsilon': 4.09810253373601e-09, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.0004836274160775511, 'tol': 1.9047223345518538e-05, 'validation_fraction': 0.6525245958434057}]
function_evaluation time 2.071943 value 0.274342 suggestion {'alpha': 0.001150633849704901, 'batch_size': 61, 'beta_1': 0.9281216925966311, 'beta_2': 0.9999987559526793, 'epsilon': 4.09810253373601e-09, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.0004836274160775511, 'tol': 1.9047223345518538e-05, 'validation_fraction': 0.6525245958434057}
observation time 0.000006, current best 0.107274 at iter 12
suggestion time taken 11.910197 iter 13 next_points [{'alpha': 0.001299635902672269, 'batch_size': 58, 'beta_1': 0.9510800290030894, 'beta_2': 0.999879180341694, 'epsilon': 2.4407582745966564e-09, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.00020435683527875086, 'tol': 0.0005485138140412241, 'validation_fraction': 0.7146666634486716}]
function_evaluation time 3.282329 value 0.394485 suggestion {'alpha': 0.001299635902672269, 'batch_size': 58, 'beta_1': 0.9510800290030894, 'beta_2': 0.999879180341694, 'epsilon': 2.4407582745966564e-09, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.00020435683527875086, 'tol': 0.0005485138140412241, 'validation_fraction': 0.7146666634486716}
observation time 0.000005, current best 0.107274 at iter 13
suggestion time taken 11.978503 iter 14 next_points [{'alpha': 1.3941595779939613e-05, 'batch_size': 222, 'beta_1': 0.9480562296981422, 'beta_2': 0.9668618916610439, 'epsilon': 5.659865209697893e-07, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.002139248590843528, 'tol': 0.00015972574117262546, 'validation_fraction': 0.8434422143841445}]
function_evaluation time 0.998311 value 0.475214 suggestion {'alpha': 1.3941595779939613e-05, 'batch_size': 222, 'beta_1': 0.9480562296981422, 'beta_2': 0.9668618916610439, 'epsilon': 5.659865209697893e-07, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.002139248590843528, 'tol': 0.00015972574117262546, 'validation_fraction': 0.8434422143841445}
observation time 0.000006, current best 0.107274 at iter 14
saving meta data: {'args': {'--uuid': 'b81a50e829a054ae802ee44e2a7e3445', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
