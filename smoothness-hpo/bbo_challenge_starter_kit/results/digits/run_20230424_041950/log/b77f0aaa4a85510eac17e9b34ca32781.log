running: {'--uuid': 'b77f0aaa4a85510eac17e9b34ca32781', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}
cmd: python random-search/optimizer.py -c MLP-adam -d digits -o random-search -u b77f0aaa4a85510eac17e9b34ca32781 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_041950
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study random-search MLP-adam digits nll 15 1
with data root: None
suggestion time taken 0.002503 iter 0 next_points [{'alpha': 0.2569852571886543, 'batch_size': 182, 'beta_1': 0.7986799945238643, 'beta_2': 0.999840346679897, 'epsilon': 4.144911904287506e-08, 'hidden_layer_sizes': 199, 'learning_rate_init': 0.000319411444358595, 'tol': 0.028464470330756858, 'validation_fraction': 0.8287234202170929}]
function_evaluation time 0.420473 value 2.273270 suggestion {'alpha': 0.2569852571886543, 'batch_size': 182, 'beta_1': 0.7986799945238643, 'beta_2': 0.999840346679897, 'epsilon': 4.144911904287506e-08, 'hidden_layer_sizes': 199, 'learning_rate_init': 0.000319411444358595, 'tol': 0.028464470330756858, 'validation_fraction': 0.8287234202170929}
observation time 0.000006, current best 2.273270 at iter 0
suggestion time taken 0.002487 iter 1 next_points [{'alpha': 0.04616911505773455, 'batch_size': 119, 'beta_1': 0.9157252627009491, 'beta_2': 0.9999765244033879, 'epsilon': 3.3220342243582965e-09, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.05340678548017113, 'tol': 2.5140865000568572e-05, 'validation_fraction': 0.8744360936279383}]
function_evaluation time 0.813910 value 1.314647 suggestion {'alpha': 0.04616911505773455, 'batch_size': 119, 'beta_1': 0.9157252627009491, 'beta_2': 0.9999765244033879, 'epsilon': 3.3220342243582965e-09, 'hidden_layer_sizes': 64, 'learning_rate_init': 0.05340678548017113, 'tol': 2.5140865000568572e-05, 'validation_fraction': 0.8744360936279383}
observation time 0.000006, current best 1.314647 at iter 1
suggestion time taken 0.002483 iter 2 next_points [{'alpha': 0.0015149896691896985, 'batch_size': 223, 'beta_1': 0.9788592065521158, 'beta_2': 0.9994917446768518, 'epsilon': 7.415396217197991e-09, 'hidden_layer_sizes': 159, 'learning_rate_init': 0.00018133051994944187, 'tol': 0.0021860876607888774, 'validation_fraction': 0.4711305353973758}]
function_evaluation time 1.958219 value 0.292185 suggestion {'alpha': 0.0015149896691896985, 'batch_size': 223, 'beta_1': 0.9788592065521158, 'beta_2': 0.9994917446768518, 'epsilon': 7.415396217197991e-09, 'hidden_layer_sizes': 159, 'learning_rate_init': 0.00018133051994944187, 'tol': 0.0021860876607888774, 'validation_fraction': 0.4711305353973758}
observation time 0.000005, current best 0.292185 at iter 2
suggestion time taken 0.002500 iter 3 next_points [{'alpha': 2.9207876373163187e-05, 'batch_size': 12, 'beta_1': 0.7266402844673658, 'beta_2': 0.9997743162229796, 'epsilon': 6.604894350952226e-09, 'hidden_layer_sizes': 84, 'learning_rate_init': 1.063603013710493e-05, 'tol': 0.004532708493288754, 'validation_fraction': 0.23208037843697185}]
function_evaluation time 8.321072 value 5.655156 suggestion {'alpha': 2.9207876373163187e-05, 'batch_size': 12, 'beta_1': 0.7266402844673658, 'beta_2': 0.9997743162229796, 'epsilon': 6.604894350952226e-09, 'hidden_layer_sizes': 84, 'learning_rate_init': 1.063603013710493e-05, 'tol': 0.004532708493288754, 'validation_fraction': 0.23208037843697185}
observation time 0.000005, current best 0.292185 at iter 3
suggestion time taken 0.002439 iter 4 next_points [{'alpha': 0.12807078171409614, 'batch_size': 240, 'beta_1': 0.9755008928657848, 'beta_2': 0.9992173749533313, 'epsilon': 8.499305324757112e-09, 'hidden_layer_sizes': 124, 'learning_rate_init': 3.9988906163012794e-05, 'tol': 0.0011331241807374037, 'validation_fraction': 0.8075898654034868}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 1.015127 value 7.564551 suggestion {'alpha': 0.12807078171409614, 'batch_size': 240, 'beta_1': 0.9755008928657848, 'beta_2': 0.9992173749533313, 'epsilon': 8.499305324757112e-09, 'hidden_layer_sizes': 124, 'learning_rate_init': 3.9988906163012794e-05, 'tol': 0.0011331241807374037, 'validation_fraction': 0.8075898654034868}
observation time 0.000006, current best 0.292185 at iter 4
suggestion time taken 0.002816 iter 5 next_points [{'alpha': 2.8674146887580414e-05, 'batch_size': 129, 'beta_1': 0.7806255933109654, 'beta_2': 0.9864874033128957, 'epsilon': 5.094018477526043e-09, 'hidden_layer_sizes': 169, 'learning_rate_init': 0.00013958616597436105, 'tol': 0.006050151011347634, 'validation_fraction': 0.7103233721047792}]
function_evaluation time 1.494626 value 0.499154 suggestion {'alpha': 2.8674146887580414e-05, 'batch_size': 129, 'beta_1': 0.7806255933109654, 'beta_2': 0.9864874033128957, 'epsilon': 5.094018477526043e-09, 'hidden_layer_sizes': 169, 'learning_rate_init': 0.00013958616597436105, 'tol': 0.006050151011347634, 'validation_fraction': 0.7103233721047792}
observation time 0.000006, current best 0.292185 at iter 5
suggestion time taken 0.002489 iter 6 next_points [{'alpha': 0.03803869015219487, 'batch_size': 50, 'beta_1': 0.6735375553314731, 'beta_2': 0.9999964379049335, 'epsilon': 1.2639201092959177e-08, 'hidden_layer_sizes': 105, 'learning_rate_init': 0.0031039418437544784, 'tol': 0.002324011210341662, 'validation_fraction': 0.7117080057625605}]
function_evaluation time 0.944901 value 0.223144 suggestion {'alpha': 0.03803869015219487, 'batch_size': 50, 'beta_1': 0.6735375553314731, 'beta_2': 0.9999964379049335, 'epsilon': 1.2639201092959177e-08, 'hidden_layer_sizes': 105, 'learning_rate_init': 0.0031039418437544784, 'tol': 0.002324011210341662, 'validation_fraction': 0.7117080057625605}
observation time 0.000006, current best 0.223144 at iter 6
suggestion time taken 0.002518 iter 7 next_points [{'alpha': 2.5020832052952438, 'batch_size': 38, 'beta_1': 0.9231111320730108, 'beta_2': 0.999949022825663, 'epsilon': 1.120222182600968e-09, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.0004698592119336124, 'tol': 0.00010965949286937541, 'validation_fraction': 0.31906998752067195}]
function_evaluation time 2.706669 value 0.175393 suggestion {'alpha': 2.5020832052952438, 'batch_size': 38, 'beta_1': 0.9231111320730108, 'beta_2': 0.999949022825663, 'epsilon': 1.120222182600968e-09, 'hidden_layer_sizes': 72, 'learning_rate_init': 0.0004698592119336124, 'tol': 0.00010965949286937541, 'validation_fraction': 0.31906998752067195}
observation time 0.000005, current best 0.175393 at iter 7
suggestion time taken 0.002465 iter 8 next_points [{'alpha': 0.059086564248693345, 'batch_size': 113, 'beta_1': 0.8895745275342031, 'beta_2': 0.9999509885246889, 'epsilon': 6.5040633298975e-08, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.04185203773472184, 'tol': 5.012870656226284e-05, 'validation_fraction': 0.16940493495670392}]
function_evaluation time 1.107423 value 0.220139 suggestion {'alpha': 0.059086564248693345, 'batch_size': 113, 'beta_1': 0.8895745275342031, 'beta_2': 0.9999509885246889, 'epsilon': 6.5040633298975e-08, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.04185203773472184, 'tol': 5.012870656226284e-05, 'validation_fraction': 0.16940493495670392}
observation time 0.000005, current best 0.175393 at iter 8
suggestion time taken 0.002486 iter 9 next_points [{'alpha': 0.0001126950576437725, 'batch_size': 48, 'beta_1': 0.9601317548801019, 'beta_2': 0.9999961079071983, 'epsilon': 9.865899675155673e-09, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0023509143385459703, 'tol': 0.007876594402303053, 'validation_fraction': 0.2294013778199859}]
function_evaluation time 0.951571 value 0.121055 suggestion {'alpha': 0.0001126950576437725, 'batch_size': 48, 'beta_1': 0.9601317548801019, 'beta_2': 0.9999961079071983, 'epsilon': 9.865899675155673e-09, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0023509143385459703, 'tol': 0.007876594402303053, 'validation_fraction': 0.2294013778199859}
observation time 0.000006, current best 0.121055 at iter 9
suggestion time taken 0.002472 iter 10 next_points [{'alpha': 0.04335934315523921, 'batch_size': 144, 'beta_1': 0.8594819089570954, 'beta_2': 0.9844593599676731, 'epsilon': 3.831635553587647e-08, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.04138178049641947, 'tol': 0.0017765914133909756, 'validation_fraction': 0.8825638745982025}]
function_evaluation time 0.625326 value 0.914101 suggestion {'alpha': 0.04335934315523921, 'batch_size': 144, 'beta_1': 0.8594819089570954, 'beta_2': 0.9844593599676731, 'epsilon': 3.831635553587647e-08, 'hidden_layer_sizes': 106, 'learning_rate_init': 0.04138178049641947, 'tol': 0.0017765914133909756, 'validation_fraction': 0.8825638745982025}
observation time 0.000005, current best 0.121055 at iter 10
suggestion time taken 0.002460 iter 11 next_points [{'alpha': 0.017023477802006137, 'batch_size': 243, 'beta_1': 0.5917988294292956, 'beta_2': 0.9999934032301747, 'epsilon': 4.571113884491593e-08, 'hidden_layer_sizes': 172, 'learning_rate_init': 9.742534322486662e-05, 'tol': 0.0037715540396830614, 'validation_fraction': 0.5137580447374662}]
function_evaluation time 2.352084 value 0.583466 suggestion {'alpha': 0.017023477802006137, 'batch_size': 243, 'beta_1': 0.5917988294292956, 'beta_2': 0.9999934032301747, 'epsilon': 4.571113884491593e-08, 'hidden_layer_sizes': 172, 'learning_rate_init': 9.742534322486662e-05, 'tol': 0.0037715540396830614, 'validation_fraction': 0.5137580447374662}
observation time 0.000005, current best 0.121055 at iter 11
suggestion time taken 0.002750 iter 12 next_points [{'alpha': 0.022155859009685957, 'batch_size': 48, 'beta_1': 0.7874942021750356, 'beta_2': 0.9898121695091165, 'epsilon': 7.395187131249171e-09, 'hidden_layer_sizes': 131, 'learning_rate_init': 0.027715785749496555, 'tol': 2.019289409857574e-05, 'validation_fraction': 0.2973521911341535}]
function_evaluation time 1.209530 value 0.219370 suggestion {'alpha': 0.022155859009685957, 'batch_size': 48, 'beta_1': 0.7874942021750356, 'beta_2': 0.9898121695091165, 'epsilon': 7.395187131249171e-09, 'hidden_layer_sizes': 131, 'learning_rate_init': 0.027715785749496555, 'tol': 2.019289409857574e-05, 'validation_fraction': 0.2973521911341535}
observation time 0.000005, current best 0.121055 at iter 12
suggestion time taken 0.002425 iter 13 next_points [{'alpha': 7.077287414658296e-05, 'batch_size': 74, 'beta_1': 0.7411034220985432, 'beta_2': 0.9500198388256685, 'epsilon': 8.313828477344714e-08, 'hidden_layer_sizes': 103, 'learning_rate_init': 0.0009927686414453645, 'tol': 0.00015858643609929603, 'validation_fraction': 0.1470452917999029}]
function_evaluation time 1.500192 value 0.107451 suggestion {'alpha': 7.077287414658296e-05, 'batch_size': 74, 'beta_1': 0.7411034220985432, 'beta_2': 0.9500198388256685, 'epsilon': 8.313828477344714e-08, 'hidden_layer_sizes': 103, 'learning_rate_init': 0.0009927686414453645, 'tol': 0.00015858643609929603, 'validation_fraction': 0.1470452917999029}
observation time 0.000006, current best 0.107451 at iter 13
suggestion time taken 0.002454 iter 14 next_points [{'alpha': 0.0008731961233704349, 'batch_size': 37, 'beta_1': 0.7680962614132189, 'beta_2': 0.9999539388998747, 'epsilon': 2.8024784759295277e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.004083963375949409, 'tol': 0.002061500653569619, 'validation_fraction': 0.7112447121573191}]
function_evaluation time 0.781927 value 0.216137 suggestion {'alpha': 0.0008731961233704349, 'batch_size': 37, 'beta_1': 0.7680962614132189, 'beta_2': 0.9999539388998747, 'epsilon': 2.8024784759295277e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.004083963375949409, 'tol': 0.002061500653569619, 'validation_fraction': 0.7112447121573191}
observation time 0.000005, current best 0.107451 at iter 14
saving meta data: {'args': {'--uuid': 'b77f0aaa4a85510eac17e9b34ca32781', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
