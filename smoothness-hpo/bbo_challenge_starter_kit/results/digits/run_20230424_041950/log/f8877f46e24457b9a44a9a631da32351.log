running: {'--uuid': 'f8877f46e24457b9a44a9a631da32351', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u f8877f46e24457b9a44a9a631da32351 -m acc -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_041950
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_acc betwen [-0.2181506  -0.12954897 -0.42701514 -0.94997127 -0.93320509] and [-0.21081107 -0.11575494 -0.27999177 -0.94225223 -0.93253861]
  warnings.warn(

Signature errors:
                           0         1         2         3         4       max
MLP-adam_digits_acc  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
max                  0.00734  0.013794  0.147023  0.007719  0.000666  0.147023
starting sklearn study smoothness MLP-adam digits acc 15 1
with data root: None
suggestion time taken 11.833979 iter 0 next_points [{'alpha': 0.00021944815394760075, 'batch_size': 178, 'beta_1': 0.9669355133594087, 'beta_2': 0.9999553131869844, 'epsilon': 3.738247241138582e-08, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.01813630097736562, 'tol': 0.0005692724182179099, 'validation_fraction': 0.19709580109288904}]
function_evaluation time 0.644337 value -0.943624 suggestion {'alpha': 0.00021944815394760075, 'batch_size': 178, 'beta_1': 0.9669355133594087, 'beta_2': 0.9999553131869844, 'epsilon': 3.738247241138582e-08, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.01813630097736562, 'tol': 0.0005692724182179099, 'validation_fraction': 0.19709580109288904}
observation time 0.000007, current best -0.943624 at iter 0
suggestion time taken 11.713029 iter 1 next_points [{'alpha': 3.437088759252458e-05, 'batch_size': 53, 'beta_1': 0.9158540688577298, 'beta_2': 0.9998094294559178, 'epsilon': 1.1704844172366235e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.011120529203115927, 'tol': 0.0009636417835238194, 'validation_fraction': 0.20672005254521197}]
function_evaluation time 1.056410 value -0.958258 suggestion {'alpha': 3.437088759252458e-05, 'batch_size': 53, 'beta_1': 0.9158540688577298, 'beta_2': 0.9998094294559178, 'epsilon': 1.1704844172366235e-08, 'hidden_layer_sizes': 88, 'learning_rate_init': 0.011120529203115927, 'tol': 0.0009636417835238194, 'validation_fraction': 0.20672005254521197}
observation time 0.000006, current best -0.958258 at iter 1
suggestion time taken 11.864189 iter 2 next_points [{'alpha': 4.979739683391281, 'batch_size': 54, 'beta_1': 0.9885345851312095, 'beta_2': 0.999462637118356, 'epsilon': 1.8938114982631315e-07, 'hidden_layer_sizes': 77, 'learning_rate_init': 4.3507656945749186e-05, 'tol': 3.1038042947596214e-05, 'validation_fraction': 0.31748061958581264}]
function_evaluation time 5.769485 value -0.740229 suggestion {'alpha': 4.979739683391281, 'batch_size': 54, 'beta_1': 0.9885345851312095, 'beta_2': 0.999462637118356, 'epsilon': 1.8938114982631315e-07, 'hidden_layer_sizes': 77, 'learning_rate_init': 4.3507656945749186e-05, 'tol': 3.1038042947596214e-05, 'validation_fraction': 0.31748061958581264}
observation time 0.000006, current best -0.958258 at iter 2
suggestion time taken 11.843726 iter 3 next_points [{'alpha': 3.0822506855292414e-05, 'batch_size': 114, 'beta_1': 0.9789404437744754, 'beta_2': 0.9999987084872257, 'epsilon': 6.833739911258099e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.05589120864845404, 'tol': 3.665650617958552e-05, 'validation_fraction': 0.2802756868450284}]
function_evaluation time 1.391839 value -0.645790 suggestion {'alpha': 3.0822506855292414e-05, 'batch_size': 114, 'beta_1': 0.9789404437744754, 'beta_2': 0.9999987084872257, 'epsilon': 6.833739911258099e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.05589120864845404, 'tol': 3.665650617958552e-05, 'validation_fraction': 0.2802756868450284}
observation time 0.000005, current best -0.958258 at iter 3
suggestion time taken 11.435913 iter 4 next_points [{'alpha': 0.016169998615095063, 'batch_size': 64, 'beta_1': 0.5401134292467439, 'beta_2': 0.9921395511145017, 'epsilon': 4.623349189660312e-08, 'hidden_layer_sizes': 112, 'learning_rate_init': 0.0006902357504893509, 'tol': 0.0008776386760419226, 'validation_fraction': 0.771733652726815}]
function_evaluation time 2.260787 value -0.920664 suggestion {'alpha': 0.016169998615095063, 'batch_size': 64, 'beta_1': 0.5401134292467439, 'beta_2': 0.9921395511145017, 'epsilon': 4.623349189660312e-08, 'hidden_layer_sizes': 112, 'learning_rate_init': 0.0006902357504893509, 'tol': 0.0008776386760419226, 'validation_fraction': 0.771733652726815}
observation time 0.000006, current best -0.958258 at iter 4
suggestion time taken 11.536191 iter 5 next_points [{'alpha': 2.014905241335058, 'batch_size': 88, 'beta_1': 0.8483469423396997, 'beta_2': 0.9997928521109535, 'epsilon': 1.1663135852487491e-07, 'hidden_layer_sizes': 106, 'learning_rate_init': 7.125255153960589e-05, 'tol': 0.0003635095569081389, 'validation_fraction': 0.8027078022956509}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 2.713562 value -0.645318 suggestion {'alpha': 2.014905241335058, 'batch_size': 88, 'beta_1': 0.8483469423396997, 'beta_2': 0.9997928521109535, 'epsilon': 1.1663135852487491e-07, 'hidden_layer_sizes': 106, 'learning_rate_init': 7.125255153960589e-05, 'tol': 0.0003635095569081389, 'validation_fraction': 0.8027078022956509}
observation time 0.000006, current best -0.958258 at iter 5
suggestion time taken 12.000606 iter 6 next_points [{'alpha': 0.5394002357400143, 'batch_size': 102, 'beta_1': 0.7396471534711451, 'beta_2': 0.9987895452289882, 'epsilon': 8.376317649601943e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 2.7829137051401343e-05, 'tol': 5.049992064111084e-05, 'validation_fraction': 0.1696950987466343}]
function_evaluation time 1.388441 value -0.283007 suggestion {'alpha': 0.5394002357400143, 'batch_size': 102, 'beta_1': 0.7396471534711451, 'beta_2': 0.9987895452289882, 'epsilon': 8.376317649601943e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 2.7829137051401343e-05, 'tol': 5.049992064111084e-05, 'validation_fraction': 0.1696950987466343}
observation time 0.000006, current best -0.958258 at iter 6
suggestion time taken 11.578314 iter 7 next_points [{'alpha': 0.0010052897427755825, 'batch_size': 62, 'beta_1': 0.9783391990236764, 'beta_2': 0.9772075531537916, 'epsilon': 3.8636042043331305e-09, 'hidden_layer_sizes': 104, 'learning_rate_init': 0.04550463207307487, 'tol': 0.0017497021496489767, 'validation_fraction': 0.42640199609708}]
function_evaluation time 1.972993 value -0.920705 suggestion {'alpha': 0.0010052897427755825, 'batch_size': 62, 'beta_1': 0.9783391990236764, 'beta_2': 0.9772075531537916, 'epsilon': 3.8636042043331305e-09, 'hidden_layer_sizes': 104, 'learning_rate_init': 0.04550463207307487, 'tol': 0.0017497021496489767, 'validation_fraction': 0.42640199609708}
observation time 0.000006, current best -0.958258 at iter 7
suggestion time taken 11.838439 iter 8 next_points [{'alpha': 0.032108735053364625, 'batch_size': 48, 'beta_1': 0.7279449231233314, 'beta_2': 0.9103476728779218, 'epsilon': 1.2845929677482693e-08, 'hidden_layer_sizes': 58, 'learning_rate_init': 9.500652311410344e-05, 'tol': 0.004219137959865125, 'validation_fraction': 0.4197586262798358}]
function_evaluation time 2.511657 value -0.889368 suggestion {'alpha': 0.032108735053364625, 'batch_size': 48, 'beta_1': 0.7279449231233314, 'beta_2': 0.9103476728779218, 'epsilon': 1.2845929677482693e-08, 'hidden_layer_sizes': 58, 'learning_rate_init': 9.500652311410344e-05, 'tol': 0.004219137959865125, 'validation_fraction': 0.4197586262798358}
observation time 0.000005, current best -0.958258 at iter 8
suggestion time taken 12.010706 iter 9 next_points [{'alpha': 1.5755391271038143e-05, 'batch_size': 50, 'beta_1': 0.9340241953916154, 'beta_2': 0.9992671842964883, 'epsilon': 4.1158817604795127e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.008897578741874251, 'tol': 0.0016912536185363996, 'validation_fraction': 0.8959458269357445}]
function_evaluation time 0.445039 value -0.875450 suggestion {'alpha': 1.5755391271038143e-05, 'batch_size': 50, 'beta_1': 0.9340241953916154, 'beta_2': 0.9992671842964883, 'epsilon': 4.1158817604795127e-07, 'hidden_layer_sizes': 51, 'learning_rate_init': 0.008897578741874251, 'tol': 0.0016912536185363996, 'validation_fraction': 0.8959458269357445}
observation time 0.000005, current best -0.958258 at iter 9
suggestion time taken 11.785856 iter 10 next_points [{'alpha': 1.458253916620832, 'batch_size': 76, 'beta_1': 0.9734128578455669, 'beta_2': 0.9996272033451223, 'epsilon': 1.415818640463844e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.011544377072850833, 'tol': 0.0003146505072592765, 'validation_fraction': 0.29384414761798344}]
function_evaluation time 1.179385 value -0.965912 suggestion {'alpha': 1.458253916620832, 'batch_size': 76, 'beta_1': 0.9734128578455669, 'beta_2': 0.9996272033451223, 'epsilon': 1.415818640463844e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.011544377072850833, 'tol': 0.0003146505072592765, 'validation_fraction': 0.29384414761798344}
observation time 0.000006, current best -0.965912 at iter 10
suggestion time taken 11.854087 iter 11 next_points [{'alpha': 5.246201111509799, 'batch_size': 76, 'beta_1': 0.9600842981560658, 'beta_2': 0.9998442759255005, 'epsilon': 1.0037654575438094e-07, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.013404259021995145, 'tol': 0.0026588757682211857, 'validation_fraction': 0.7524469875734953}]
function_evaluation time 0.528150 value -0.930410 suggestion {'alpha': 5.246201111509799, 'batch_size': 76, 'beta_1': 0.9600842981560658, 'beta_2': 0.9998442759255005, 'epsilon': 1.0037654575438094e-07, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.013404259021995145, 'tol': 0.0026588757682211857, 'validation_fraction': 0.7524469875734953}
observation time 0.000006, current best -0.965912 at iter 11
suggestion time taken 11.874553 iter 12 next_points [{'alpha': 0.06671237508969069, 'batch_size': 97, 'beta_1': 0.8107684469092263, 'beta_2': 0.9999952977247256, 'epsilon': 1.0196138022029e-08, 'hidden_layer_sizes': 90, 'learning_rate_init': 0.0018282114219328295, 'tol': 0.0018128612276611224, 'validation_fraction': 0.2703880414401177}]
function_evaluation time 1.228458 value -0.951302 suggestion {'alpha': 0.06671237508969069, 'batch_size': 97, 'beta_1': 0.8107684469092263, 'beta_2': 0.9999952977247256, 'epsilon': 1.0196138022029e-08, 'hidden_layer_sizes': 90, 'learning_rate_init': 0.0018282114219328295, 'tol': 0.0018128612276611224, 'validation_fraction': 0.2703880414401177}
observation time 0.000005, current best -0.965912 at iter 12
suggestion time taken 11.840631 iter 13 next_points [{'alpha': 0.000740830277002738, 'batch_size': 22, 'beta_1': 0.8355595697615986, 'beta_2': 0.9995387002195713, 'epsilon': 1.919453552330884e-08, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.057553403478572615, 'tol': 0.00019884495412374634, 'validation_fraction': 0.42889522398121627}]
function_evaluation time 1.140710 value -0.641551 suggestion {'alpha': 0.000740830277002738, 'batch_size': 22, 'beta_1': 0.8355595697615986, 'beta_2': 0.9995387002195713, 'epsilon': 1.919453552330884e-08, 'hidden_layer_sizes': 57, 'learning_rate_init': 0.057553403478572615, 'tol': 0.00019884495412374634, 'validation_fraction': 0.42889522398121627}
observation time 0.000004, current best -0.965912 at iter 13
suggestion time taken 11.637716 iter 14 next_points [{'alpha': 1.910952462558009e-05, 'batch_size': 88, 'beta_1': 0.5156716568650623, 'beta_2': 0.9958348690000699, 'epsilon': 9.748988184207011e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.0015274510426364913, 'tol': 0.0008552783178992181, 'validation_fraction': 0.14876673158924972}]
function_evaluation time 1.138990 value -0.954779 suggestion {'alpha': 1.910952462558009e-05, 'batch_size': 88, 'beta_1': 0.5156716568650623, 'beta_2': 0.9958348690000699, 'epsilon': 9.748988184207011e-09, 'hidden_layer_sizes': 86, 'learning_rate_init': 0.0015274510426364913, 'tol': 0.0008552783178992181, 'validation_fraction': 0.14876673158924972}
observation time 0.000005, current best -0.965912 at iter 14
saving meta data: {'args': {'--uuid': 'f8877f46e24457b9a44a9a631da32351', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'acc', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [-0.21081107239643826, -0.1295489740611692, -0.27999177313201706, -0.9422522260936896, -0.9332050909794812])}
saving results
saving timing
saving suggest log
done
