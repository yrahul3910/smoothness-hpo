running: {'--uuid': '4a9a7919f99d53f09ce4bab02d5fc937', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}
cmd: python random-search/optimizer.py -c MLP-adam -d digits -o random-search -u 4a9a7919f99d53f09ce4bab02d5fc937 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_041950
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study random-search MLP-adam digits nll 15 1
with data root: None
suggestion time taken 0.002555 iter 0 next_points [{'alpha': 0.0006076520798762355, 'batch_size': 198, 'beta_1': 0.9889220484403305, 'beta_2': 0.9785593970210719, 'epsilon': 8.262531981120442e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0057937703846442385, 'tol': 3.9774544090678405e-05, 'validation_fraction': 0.16132611719453557}]
function_evaluation time 0.980435 value 0.204085 suggestion {'alpha': 0.0006076520798762355, 'batch_size': 198, 'beta_1': 0.9889220484403305, 'beta_2': 0.9785593970210719, 'epsilon': 8.262531981120442e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.0057937703846442385, 'tol': 3.9774544090678405e-05, 'validation_fraction': 0.16132611719453557}
observation time 0.000007, current best 0.204085 at iter 0
suggestion time taken 0.002481 iter 1 next_points [{'alpha': 2.6282693856180055, 'batch_size': 41, 'beta_1': 0.7505452019209831, 'beta_2': 0.9994815161284144, 'epsilon': 1.1389948880683837e-08, 'hidden_layer_sizes': 100, 'learning_rate_init': 0.05263778360188479, 'tol': 0.00014531581194113954, 'validation_fraction': 0.8284004159153622}]
function_evaluation time 0.685061 value 0.314967 suggestion {'alpha': 2.6282693856180055, 'batch_size': 41, 'beta_1': 0.7505452019209831, 'beta_2': 0.9994815161284144, 'epsilon': 1.1389948880683837e-08, 'hidden_layer_sizes': 100, 'learning_rate_init': 0.05263778360188479, 'tol': 0.00014531581194113954, 'validation_fraction': 0.8284004159153622}
observation time 0.000004, current best 0.204085 at iter 1
suggestion time taken 0.002537 iter 2 next_points [{'alpha': 0.06901248541993647, 'batch_size': 175, 'beta_1': 0.9834888433853218, 'beta_2': 0.9999961144980444, 'epsilon': 1.4430855780426652e-09, 'hidden_layer_sizes': 198, 'learning_rate_init': 6.894382635302161e-05, 'tol': 1.1760791892925595e-05, 'validation_fraction': 0.27781309889487726}]
function_evaluation time 4.820913 value 0.282182 suggestion {'alpha': 0.06901248541993647, 'batch_size': 175, 'beta_1': 0.9834888433853218, 'beta_2': 0.9999961144980444, 'epsilon': 1.4430855780426652e-09, 'hidden_layer_sizes': 198, 'learning_rate_init': 6.894382635302161e-05, 'tol': 1.1760791892925595e-05, 'validation_fraction': 0.27781309889487726}
observation time 0.000005, current best 0.204085 at iter 2
suggestion time taken 0.002467 iter 3 next_points [{'alpha': 0.16997091593812655, 'batch_size': 250, 'beta_1': 0.8504286266989676, 'beta_2': 0.9997972848796324, 'epsilon': 1.6551696847516372e-08, 'hidden_layer_sizes': 97, 'learning_rate_init': 9.677410609176316e-05, 'tol': 0.07495968411399424, 'validation_fraction': 0.8176402773173668}]
function_evaluation time 0.148781 value 7.402299 suggestion {'alpha': 0.16997091593812655, 'batch_size': 250, 'beta_1': 0.8504286266989676, 'beta_2': 0.9997972848796324, 'epsilon': 1.6551696847516372e-08, 'hidden_layer_sizes': 97, 'learning_rate_init': 9.677410609176316e-05, 'tol': 0.07495968411399424, 'validation_fraction': 0.8176402773173668}
observation time 0.000005, current best 0.204085 at iter 3
suggestion time taken 0.002478 iter 4 next_points [{'alpha': 3.3994052711632583, 'batch_size': 149, 'beta_1': 0.9888942634778541, 'beta_2': 0.9999970601359427, 'epsilon': 2.4590997909099707e-08, 'hidden_layer_sizes': 130, 'learning_rate_init': 0.00567987471191481, 'tol': 0.005505076274540357, 'validation_fraction': 0.5709990624341804}]
function_evaluation time 0.577991 value 0.250361 suggestion {'alpha': 3.3994052711632583, 'batch_size': 149, 'beta_1': 0.9888942634778541, 'beta_2': 0.9999970601359427, 'epsilon': 2.4590997909099707e-08, 'hidden_layer_sizes': 130, 'learning_rate_init': 0.00567987471191481, 'tol': 0.005505076274540357, 'validation_fraction': 0.5709990624341804}
observation time 0.000005, current best 0.204085 at iter 4
suggestion time taken 0.002723 iter 5 next_points [{'alpha': 8.465492354003052e-05, 'batch_size': 34, 'beta_1': 0.8898680399978081, 'beta_2': 0.9969991933484884, 'epsilon': 1.1922118729479684e-07, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.005227389501850322, 'tol': 0.05506600545945476, 'validation_fraction': 0.18208677340078894}]
function_evaluation time 0.678291 value 0.119104 suggestion {'alpha': 8.465492354003052e-05, 'batch_size': 34, 'beta_1': 0.8898680399978081, 'beta_2': 0.9969991933484884, 'epsilon': 1.1922118729479684e-07, 'hidden_layer_sizes': 73, 'learning_rate_init': 0.005227389501850322, 'tol': 0.05506600545945476, 'validation_fraction': 0.18208677340078894}
observation time 0.000005, current best 0.119104 at iter 5
suggestion time taken 0.002444 iter 6 next_points [{'alpha': 1.1193109952325415, 'batch_size': 195, 'beta_1': 0.8959868297540169, 'beta_2': 0.9999958748015026, 'epsilon': 1.1885423386559763e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.019214827520376843, 'tol': 0.0015996334888871214, 'validation_fraction': 0.37003410128676206}]
function_evaluation time 0.899942 value 0.140175 suggestion {'alpha': 1.1193109952325415, 'batch_size': 195, 'beta_1': 0.8959868297540169, 'beta_2': 0.9999958748015026, 'epsilon': 1.1885423386559763e-09, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.019214827520376843, 'tol': 0.0015996334888871214, 'validation_fraction': 0.37003410128676206}
observation time 0.000005, current best 0.119104 at iter 6
suggestion time taken 0.002526 iter 7 next_points [{'alpha': 0.00022162317229530704, 'batch_size': 64, 'beta_1': 0.9644418220393947, 'beta_2': 0.9949871408807748, 'epsilon': 1.3313622547375578e-08, 'hidden_layer_sizes': 166, 'learning_rate_init': 9.995383501483986e-05, 'tol': 0.005071906369667534, 'validation_fraction': 0.8392162833617329}]
function_evaluation time 1.304142 value 3.473549 suggestion {'alpha': 0.00022162317229530704, 'batch_size': 64, 'beta_1': 0.9644418220393947, 'beta_2': 0.9949871408807748, 'epsilon': 1.3313622547375578e-08, 'hidden_layer_sizes': 166, 'learning_rate_init': 9.995383501483986e-05, 'tol': 0.005071906369667534, 'validation_fraction': 0.8392162833617329}
observation time 0.000005, current best 0.119104 at iter 7
suggestion time taken 0.002411 iter 8 next_points [{'alpha': 0.13745558851214307, 'batch_size': 118, 'beta_1': 0.9862141665243334, 'beta_2': 0.9939266883024623, 'epsilon': 7.671103744219475e-09, 'hidden_layer_sizes': 116, 'learning_rate_init': 1.0632193521977413e-05, 'tol': 3.1398663952780735e-05, 'validation_fraction': 0.7346929434605356}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 1.548014 value 8.045168 suggestion {'alpha': 0.13745558851214307, 'batch_size': 118, 'beta_1': 0.9862141665243334, 'beta_2': 0.9939266883024623, 'epsilon': 7.671103744219475e-09, 'hidden_layer_sizes': 116, 'learning_rate_init': 1.0632193521977413e-05, 'tol': 3.1398663952780735e-05, 'validation_fraction': 0.7346929434605356}
observation time 0.000004, current best 0.119104 at iter 8
suggestion time taken 0.002677 iter 9 next_points [{'alpha': 0.020985755107773254, 'batch_size': 182, 'beta_1': 0.9167340150492269, 'beta_2': 0.9849812698999849, 'epsilon': 1.2922420882751435e-08, 'hidden_layer_sizes': 175, 'learning_rate_init': 1.2313207841721294e-05, 'tol': 0.0003167573140778151, 'validation_fraction': 0.239920855030188}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 2.568671 value 6.516071 suggestion {'alpha': 0.020985755107773254, 'batch_size': 182, 'beta_1': 0.9167340150492269, 'beta_2': 0.9849812698999849, 'epsilon': 1.2922420882751435e-08, 'hidden_layer_sizes': 175, 'learning_rate_init': 1.2313207841721294e-05, 'tol': 0.0003167573140778151, 'validation_fraction': 0.239920855030188}
observation time 0.000005, current best 0.119104 at iter 9
suggestion time taken 0.002409 iter 10 next_points [{'alpha': 0.3193075323961618, 'batch_size': 237, 'beta_1': 0.6352109057242509, 'beta_2': 0.9998591642286827, 'epsilon': 4.841942948427139e-09, 'hidden_layer_sizes': 117, 'learning_rate_init': 0.0035792725533702377, 'tol': 0.003073452238216719, 'validation_fraction': 0.39153520574023337}]
function_evaluation time 0.792979 value 0.136891 suggestion {'alpha': 0.3193075323961618, 'batch_size': 237, 'beta_1': 0.6352109057242509, 'beta_2': 0.9998591642286827, 'epsilon': 4.841942948427139e-09, 'hidden_layer_sizes': 117, 'learning_rate_init': 0.0035792725533702377, 'tol': 0.003073452238216719, 'validation_fraction': 0.39153520574023337}
observation time 0.000004, current best 0.119104 at iter 10
suggestion time taken 0.002431 iter 11 next_points [{'alpha': 1.3464176678134583, 'batch_size': 30, 'beta_1': 0.9038394150728671, 'beta_2': 0.9999851688172764, 'epsilon': 8.918375274780481e-08, 'hidden_layer_sizes': 135, 'learning_rate_init': 1.3478701928615278e-05, 'tol': 0.043446670635292804, 'validation_fraction': 0.4410618945945715}]
function_evaluation time 0.728474 value 6.990043 suggestion {'alpha': 1.3464176678134583, 'batch_size': 30, 'beta_1': 0.9038394150728671, 'beta_2': 0.9999851688172764, 'epsilon': 8.918375274780481e-08, 'hidden_layer_sizes': 135, 'learning_rate_init': 1.3478701928615278e-05, 'tol': 0.043446670635292804, 'validation_fraction': 0.4410618945945715}
observation time 0.000005, current best 0.119104 at iter 11
suggestion time taken 0.002431 iter 12 next_points [{'alpha': 2.376434457595391, 'batch_size': 198, 'beta_1': 0.8681805550187839, 'beta_2': 0.9999010539601191, 'epsilon': 9.760090169671851e-07, 'hidden_layer_sizes': 150, 'learning_rate_init': 0.0014774222043311355, 'tol': 0.05045732477506015, 'validation_fraction': 0.6913571059028825}]
function_evaluation time 0.330962 value 0.289829 suggestion {'alpha': 2.376434457595391, 'batch_size': 198, 'beta_1': 0.8681805550187839, 'beta_2': 0.9999010539601191, 'epsilon': 9.760090169671851e-07, 'hidden_layer_sizes': 150, 'learning_rate_init': 0.0014774222043311355, 'tol': 0.05045732477506015, 'validation_fraction': 0.6913571059028825}
observation time 0.000004, current best 0.119104 at iter 12
suggestion time taken 0.002881 iter 13 next_points [{'alpha': 0.0001336898085669791, 'batch_size': 23, 'beta_1': 0.9752861925249735, 'beta_2': 0.9998698659932603, 'epsilon': 2.2553091525494283e-08, 'hidden_layer_sizes': 174, 'learning_rate_init': 5.79192498673342e-05, 'tol': 0.0001609602807193326, 'validation_fraction': 0.11847927717042778}]
function_evaluation time 7.972834 value 0.202379 suggestion {'alpha': 0.0001336898085669791, 'batch_size': 23, 'beta_1': 0.9752861925249735, 'beta_2': 0.9998698659932603, 'epsilon': 2.2553091525494283e-08, 'hidden_layer_sizes': 174, 'learning_rate_init': 5.79192498673342e-05, 'tol': 0.0001609602807193326, 'validation_fraction': 0.11847927717042778}
observation time 0.000005, current best 0.119104 at iter 13
suggestion time taken 0.002491 iter 14 next_points [{'alpha': 0.012591581938730063, 'batch_size': 59, 'beta_1': 0.932967413373923, 'beta_2': 0.9870328216609654, 'epsilon': 1.7193045405291665e-09, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.00021777277205753772, 'tol': 4.745345899417263e-05, 'validation_fraction': 0.7747069227843905}]
function_evaluation time 3.404209 value 0.268668 suggestion {'alpha': 0.012591581938730063, 'batch_size': 59, 'beta_1': 0.932967413373923, 'beta_2': 0.9870328216609654, 'epsilon': 1.7193045405291665e-09, 'hidden_layer_sizes': 157, 'learning_rate_init': 0.00021777277205753772, 'tol': 4.745345899417263e-05, 'validation_fraction': 0.7747069227843905}
observation time 0.000005, current best 0.119104 at iter 14
saving meta data: {'args': {'--uuid': '4a9a7919f99d53f09ce4bab02d5fc937', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'random-search', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': '0.0.8'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
