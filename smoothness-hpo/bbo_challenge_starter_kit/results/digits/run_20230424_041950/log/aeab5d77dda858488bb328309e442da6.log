running: {'--uuid': 'aeab5d77dda858488bb328309e442da6', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d digits -o smoothness -u aeab5d77dda858488bb328309e442da6 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_041950
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_digits_nll betwen [4.71022664 9.71262277 5.92543888 0.18972466 0.25190217] and [ 4.87095228 10.02890359  5.95079183  0.19438427  0.26094505]
  warnings.warn(

Signature errors:
                            0         1         2        3         4       max
MLP-adam_digits_nll  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
max                  0.160726  0.316281  0.025353  0.00466  0.009043  0.316281
starting sklearn study smoothness MLP-adam digits nll 15 1
with data root: None
suggestion time taken 11.702124 iter 0 next_points [{'alpha': 0.4410803558371078, 'batch_size': 46, 'beta_1': 0.5599761882202454, 'beta_2': 0.9306505046977601, 'epsilon': 6.151162768604532e-09, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.031317251182187096, 'tol': 1.667063491106549e-05, 'validation_fraction': 0.1389411209973097}]
function_evaluation time 1.041119 value 0.203431 suggestion {'alpha': 0.4410803558371078, 'batch_size': 46, 'beta_1': 0.5599761882202454, 'beta_2': 0.9306505046977601, 'epsilon': 6.151162768604532e-09, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.031317251182187096, 'tol': 1.667063491106549e-05, 'validation_fraction': 0.1389411209973097}
observation time 0.000007, current best 0.203431 at iter 0
suggestion time taken 11.898384 iter 1 next_points [{'alpha': 9.474301503854089e-05, 'batch_size': 38, 'beta_1': 0.6721603825480257, 'beta_2': 0.9946070589178929, 'epsilon': 6.470672331159542e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.004263418729751332, 'tol': 0.0017248285537590647, 'validation_fraction': 0.8011081339710926}]
function_evaluation time 0.738244 value 0.346982 suggestion {'alpha': 9.474301503854089e-05, 'batch_size': 38, 'beta_1': 0.6721603825480257, 'beta_2': 0.9946070589178929, 'epsilon': 6.470672331159542e-09, 'hidden_layer_sizes': 62, 'learning_rate_init': 0.004263418729751332, 'tol': 0.0017248285537590647, 'validation_fraction': 0.8011081339710926}
observation time 0.000005, current best 0.203431 at iter 1
suggestion time taken 11.395382 iter 2 next_points [{'alpha': 4.822678550036075e-05, 'batch_size': 179, 'beta_1': 0.9450925130700681, 'beta_2': 0.9999631243486011, 'epsilon': 3.6597601440749633e-08, 'hidden_layer_sizes': 71, 'learning_rate_init': 1.1644488010103223e-05, 'tol': 0.0006860483456093949, 'validation_fraction': 0.39333052371686655}]
function_evaluation time 0.395512 value 10.560354 suggestion {'alpha': 4.822678550036075e-05, 'batch_size': 179, 'beta_1': 0.9450925130700681, 'beta_2': 0.9999631243486011, 'epsilon': 3.6597601440749633e-08, 'hidden_layer_sizes': 71, 'learning_rate_init': 1.1644488010103223e-05, 'tol': 0.0006860483456093949, 'validation_fraction': 0.39333052371686655}
observation time 0.000006, current best 0.203431 at iter 2
suggestion time taken 12.250754 iter 3 next_points [{'alpha': 0.00010087988826467023, 'batch_size': 120, 'beta_1': 0.5517420479159375, 'beta_2': 0.9984564930996254, 'epsilon': 3.1786002950917545e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.027984276038527142, 'tol': 0.0004104963854981538, 'validation_fraction': 0.8753946647642302}]
function_evaluation time 0.568101 value 0.398485 suggestion {'alpha': 0.00010087988826467023, 'batch_size': 120, 'beta_1': 0.5517420479159375, 'beta_2': 0.9984564930996254, 'epsilon': 3.1786002950917545e-09, 'hidden_layer_sizes': 52, 'learning_rate_init': 0.027984276038527142, 'tol': 0.0004104963854981538, 'validation_fraction': 0.8753946647642302}
observation time 0.000006, current best 0.203431 at iter 3
suggestion time taken 11.716257 iter 4 next_points [{'alpha': 1.4105188550161666e-05, 'batch_size': 65, 'beta_1': 0.921459142965991, 'beta_2': 0.999630501077665, 'epsilon': 9.843605732908092e-08, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.08776727246274443, 'tol': 0.001951761055571873, 'validation_fraction': 0.2615086704856922}]
function_evaluation time 0.591888 value 2.034919 suggestion {'alpha': 1.4105188550161666e-05, 'batch_size': 65, 'beta_1': 0.921459142965991, 'beta_2': 0.999630501077665, 'epsilon': 9.843605732908092e-08, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.08776727246274443, 'tol': 0.001951761055571873, 'validation_fraction': 0.2615086704856922}
observation time 0.000005, current best 0.203431 at iter 4
suggestion time taken 11.968654 iter 5 next_points [{'alpha': 0.11119278688814756, 'batch_size': 89, 'beta_1': 0.9873705423466902, 'beta_2': 0.9843609570993199, 'epsilon': 4.339100715093198e-09, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.0021789195453675043, 'tol': 0.003391220051719409, 'validation_fraction': 0.28732421397197194}]
function_evaluation time 0.913086 value 0.171013 suggestion {'alpha': 0.11119278688814756, 'batch_size': 89, 'beta_1': 0.9873705423466902, 'beta_2': 0.9843609570993199, 'epsilon': 4.339100715093198e-09, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.0021789195453675043, 'tol': 0.003391220051719409, 'validation_fraction': 0.28732421397197194}
observation time 0.000006, current best 0.171013 at iter 5
suggestion time taken 12.290086 iter 6 next_points [{'alpha': 0.13186811312933067, 'batch_size': 59, 'beta_1': 0.9897363679534199, 'beta_2': 0.9997578690629015, 'epsilon': 3.3557130810726625e-07, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.0023650218140986914, 'tol': 2.2239539599522757e-05, 'validation_fraction': 0.855381165500787}]
function_evaluation time 0.732280 value 0.546090 suggestion {'alpha': 0.13186811312933067, 'batch_size': 59, 'beta_1': 0.9897363679534199, 'beta_2': 0.9997578690629015, 'epsilon': 3.3557130810726625e-07, 'hidden_layer_sizes': 58, 'learning_rate_init': 0.0023650218140986914, 'tol': 2.2239539599522757e-05, 'validation_fraction': 0.855381165500787}
observation time 0.000005, current best 0.171013 at iter 6
suggestion time taken 11.524036 iter 7 next_points [{'alpha': 0.0003281832075719035, 'batch_size': 79, 'beta_1': 0.7970378596648156, 'beta_2': 0.9999960748725244, 'epsilon': 4.716090983889455e-09, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.002979405818890693, 'tol': 0.034000361956806745, 'validation_fraction': 0.608474713653497}]
function_evaluation time 0.358655 value 0.279438 suggestion {'alpha': 0.0003281832075719035, 'batch_size': 79, 'beta_1': 0.7970378596648156, 'beta_2': 0.9999960748725244, 'epsilon': 4.716090983889455e-09, 'hidden_layer_sizes': 61, 'learning_rate_init': 0.002979405818890693, 'tol': 0.034000361956806745, 'validation_fraction': 0.608474713653497}
observation time 0.000005, current best 0.171013 at iter 7
suggestion time taken 11.782666 iter 8 next_points [{'alpha': 0.0008224514073127763, 'batch_size': 197, 'beta_1': 0.9217760522426016, 'beta_2': 0.9820144378088342, 'epsilon': 1.3637827065417385e-07, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.00021022113794297802, 'tol': 0.002766365948948004, 'validation_fraction': 0.7333542174746558}]
function_evaluation time 1.169719 value 3.509740 suggestion {'alpha': 0.0008224514073127763, 'batch_size': 197, 'beta_1': 0.9217760522426016, 'beta_2': 0.9820144378088342, 'epsilon': 1.3637827065417385e-07, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.00021022113794297802, 'tol': 0.002766365948948004, 'validation_fraction': 0.7333542174746558}
observation time 0.000005, current best 0.171013 at iter 8
suggestion time taken 11.787281 iter 9 next_points [{'alpha': 0.010705600790424598, 'batch_size': 29, 'beta_1': 0.7252499101421734, 'beta_2': 0.9956498849836326, 'epsilon': 2.4110698765087257e-09, 'hidden_layer_sizes': 58, 'learning_rate_init': 1.0639518702986939e-05, 'tol': 0.0001053204830095499, 'validation_fraction': 0.2960148635948905}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 7.467926 value 5.789975 suggestion {'alpha': 0.010705600790424598, 'batch_size': 29, 'beta_1': 0.7252499101421734, 'beta_2': 0.9956498849836326, 'epsilon': 2.4110698765087257e-09, 'hidden_layer_sizes': 58, 'learning_rate_init': 1.0639518702986939e-05, 'tol': 0.0001053204830095499, 'validation_fraction': 0.2960148635948905}
observation time 0.000005, current best 0.171013 at iter 9
suggestion time taken 11.663804 iter 10 next_points [{'alpha': 0.241271656801883, 'batch_size': 24, 'beta_1': 0.5644760338667681, 'beta_2': 0.9989838539249313, 'epsilon': 1.94343742055971e-08, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.020331347800166776, 'tol': 0.00017988655765324368, 'validation_fraction': 0.41169494531073125}]
function_evaluation time 1.375235 value 0.166217 suggestion {'alpha': 0.241271656801883, 'batch_size': 24, 'beta_1': 0.5644760338667681, 'beta_2': 0.9989838539249313, 'epsilon': 1.94343742055971e-08, 'hidden_layer_sizes': 63, 'learning_rate_init': 0.020331347800166776, 'tol': 0.00017988655765324368, 'validation_fraction': 0.41169494531073125}
observation time 0.000015, current best 0.166217 at iter 10
suggestion time taken 11.781237 iter 11 next_points [{'alpha': 0.018778926795879263, 'batch_size': 66, 'beta_1': 0.9397755718426241, 'beta_2': 0.9999971049834139, 'epsilon': 1.2315310697319405e-08, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.005342950284124428, 'tol': 1.7392015983686985e-05, 'validation_fraction': 0.6335395516548168}]
function_evaluation time 0.877649 value 0.195878 suggestion {'alpha': 0.018778926795879263, 'batch_size': 66, 'beta_1': 0.9397755718426241, 'beta_2': 0.9999971049834139, 'epsilon': 1.2315310697319405e-08, 'hidden_layer_sizes': 84, 'learning_rate_init': 0.005342950284124428, 'tol': 1.7392015983686985e-05, 'validation_fraction': 0.6335395516548168}
observation time 0.000005, current best 0.166217 at iter 11
suggestion time taken 11.523129 iter 12 next_points [{'alpha': 0.007397640722517836, 'batch_size': 87, 'beta_1': 0.9872724199551351, 'beta_2': 0.9992527679614721, 'epsilon': 3.4660580479746364e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0022343090156380567, 'tol': 9.96531579277664e-05, 'validation_fraction': 0.7937457815225621}]
function_evaluation time 0.877308 value 0.428220 suggestion {'alpha': 0.007397640722517836, 'batch_size': 87, 'beta_1': 0.9872724199551351, 'beta_2': 0.9992527679614721, 'epsilon': 3.4660580479746364e-09, 'hidden_layer_sizes': 53, 'learning_rate_init': 0.0022343090156380567, 'tol': 9.96531579277664e-05, 'validation_fraction': 0.7937457815225621}
observation time 0.000006, current best 0.166217 at iter 12
suggestion time taken 12.194976 iter 13 next_points [{'alpha': 0.00605009627568317, 'batch_size': 62, 'beta_1': 0.670235670747726, 'beta_2': 0.999848358319162, 'epsilon': 3.838649154373814e-09, 'hidden_layer_sizes': 72, 'learning_rate_init': 6.682016909417139e-05, 'tol': 4.462051864131174e-05, 'validation_fraction': 0.7575777070578947}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:686: ConvergenceWarning: Stochastic Optimizer: Maximum iterations (200) reached and the optimization hasn't converged yet.
  warnings.warn(

function_evaluation time 3.077556 value 3.182540 suggestion {'alpha': 0.00605009627568317, 'batch_size': 62, 'beta_1': 0.670235670747726, 'beta_2': 0.999848358319162, 'epsilon': 3.838649154373814e-09, 'hidden_layer_sizes': 72, 'learning_rate_init': 6.682016909417139e-05, 'tol': 4.462051864131174e-05, 'validation_fraction': 0.7575777070578947}
observation time 0.000006, current best 0.166217 at iter 13
suggestion time taken 11.423699 iter 14 next_points [{'alpha': 3.100860369772673, 'batch_size': 109, 'beta_1': 0.8634602076452564, 'beta_2': 0.9999839928742695, 'epsilon': 8.105640944627063e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.007188006997025068, 'tol': 0.0003997240048979294, 'validation_fraction': 0.8246525049041296}]
function_evaluation time 0.827411 value 0.272044 suggestion {'alpha': 3.100860369772673, 'batch_size': 109, 'beta_1': 0.8634602076452564, 'beta_2': 0.9999839928742695, 'epsilon': 8.105640944627063e-07, 'hidden_layer_sizes': 54, 'learning_rate_init': 0.007188006997025068, 'tol': 0.0003997240048979294, 'validation_fraction': 0.8246525049041296}
observation time 0.000005, current best 0.166217 at iter 14
saving meta data: {'args': {'--uuid': 'aeab5d77dda858488bb328309e442da6', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_041950', '--opt': 'smoothness', '--data': 'digits', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [4.8709522768835765, 9.712622772033223, 5.950791832993735, 0.19438427080405424, 0.251902166999456])}
saving results
saving timing
saving suggest log
done
