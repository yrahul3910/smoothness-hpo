running: {'--uuid': '4f715ec8622750f88ae70cb633900a59', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_224500', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d wine -o smoothness -u 4f715ec8622750f88ae70cb633900a59 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_224500
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_wine_nll betwen [15.51998549 22.35390307 19.16402613  3.37792524 14.64310022] and [16.06396227 23.27425025 19.80193088  3.46391821 15.2105797 ]
  warnings.warn(

Signature errors:
                          0         1         2         3         4       max
MLP-adam_wine_nll  0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
max                0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
starting sklearn study smoothness MLP-adam wine nll 15 1
with data root: None
suggestion time taken 10.915690 iter 0 next_points [{'alpha': 0.043303806962886514, 'batch_size': 16, 'beta_1': 0.9669445496813504, 'beta_2': 0.9999799843148279, 'epsilon': 2.568871301921734e-07, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.003264815645117814, 'tol': 0.03289269162082687, 'validation_fraction': 0.4451276950103598}]
function_evaluation time 0.174347 value 0.945916 suggestion {'alpha': 0.043303806962886514, 'batch_size': 16, 'beta_1': 0.9669445496813504, 'beta_2': 0.9999799843148279, 'epsilon': 2.568871301921734e-07, 'hidden_layer_sizes': 69, 'learning_rate_init': 0.003264815645117814, 'tol': 0.03289269162082687, 'validation_fraction': 0.4451276950103598}
observation time 0.000007, current best 0.945916 at iter 0
suggestion time taken 11.025655 iter 1 next_points [{'alpha': 2.276591613695801, 'batch_size': 18, 'beta_1': 0.5816530878373933, 'beta_2': 0.9999860328550995, 'epsilon': 2.7360476221565758e-08, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.020613217484066658, 'tol': 0.04903926520715853, 'validation_fraction': 0.23699761219495455}]
function_evaluation time 0.193872 value 1.296357 suggestion {'alpha': 2.276591613695801, 'batch_size': 18, 'beta_1': 0.5816530878373933, 'beta_2': 0.9999860328550995, 'epsilon': 2.7360476221565758e-08, 'hidden_layer_sizes': 111, 'learning_rate_init': 0.020613217484066658, 'tol': 0.04903926520715853, 'validation_fraction': 0.23699761219495455}
observation time 0.000006, current best 0.945916 at iter 1
suggestion time taken 10.755384 iter 2 next_points [{'alpha': 5.3948316928088576e-05, 'batch_size': 26, 'beta_1': 0.8292759747294041, 'beta_2': 0.9999761232578219, 'epsilon': 1.209018391058447e-08, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.0009495744213481283, 'tol': 0.009437697306127849, 'validation_fraction': 0.7174651516675539}]
function_evaluation time 0.112665 value 2.938967 suggestion {'alpha': 5.3948316928088576e-05, 'batch_size': 26, 'beta_1': 0.8292759747294041, 'beta_2': 0.9999761232578219, 'epsilon': 1.209018391058447e-08, 'hidden_layer_sizes': 93, 'learning_rate_init': 0.0009495744213481283, 'tol': 0.009437697306127849, 'validation_fraction': 0.7174651516675539}
observation time 0.000006, current best 0.945916 at iter 2
suggestion time taken 11.067642 iter 3 next_points [{'alpha': 0.1819847963260852, 'batch_size': 29, 'beta_1': 0.9659890641698909, 'beta_2': 0.999996119139808, 'epsilon': 8.401853672556062e-08, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.0022521936429413954, 'tol': 0.016595125482569934, 'validation_fraction': 0.32266837477521293}]
function_evaluation time 0.249233 value 4.222246 suggestion {'alpha': 0.1819847963260852, 'batch_size': 29, 'beta_1': 0.9659890641698909, 'beta_2': 0.999996119139808, 'epsilon': 8.401853672556062e-08, 'hidden_layer_sizes': 134, 'learning_rate_init': 0.0022521936429413954, 'tol': 0.016595125482569934, 'validation_fraction': 0.32266837477521293}
observation time 0.000006, current best 0.945916 at iter 3
suggestion time taken 10.830623 iter 4 next_points [{'alpha': 0.00837379639815931, 'batch_size': 10, 'beta_1': 0.9115764979328683, 'beta_2': 0.9999527176564048, 'epsilon': 4.470629998474821e-09, 'hidden_layer_sizes': 114, 'learning_rate_init': 6.389638519524839e-05, 'tol': 0.0102987295323707, 'validation_fraction': 0.5233343193628919}]
function_evaluation time 0.179479 value 19.362317 suggestion {'alpha': 0.00837379639815931, 'batch_size': 10, 'beta_1': 0.9115764979328683, 'beta_2': 0.9999527176564048, 'epsilon': 4.470629998474821e-09, 'hidden_layer_sizes': 114, 'learning_rate_init': 6.389638519524839e-05, 'tol': 0.0102987295323707, 'validation_fraction': 0.5233343193628919}
observation time 0.000006, current best 0.945916 at iter 4
suggestion time taken 10.742600 iter 5 next_points [{'alpha': 0.00015522131605770248, 'batch_size': 32, 'beta_1': 0.7780830487714515, 'beta_2': 0.9999980440271989, 'epsilon': 4.026387159005705e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 2.4464621630502896e-05, 'tol': 0.029847247336278308, 'validation_fraction': 0.8927792179239035}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.048400 value 23.832931 suggestion {'alpha': 0.00015522131605770248, 'batch_size': 32, 'beta_1': 0.7780830487714515, 'beta_2': 0.9999980440271989, 'epsilon': 4.026387159005705e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 2.4464621630502896e-05, 'tol': 0.029847247336278308, 'validation_fraction': 0.8927792179239035}
observation time 0.000006, current best 0.945916 at iter 5
suggestion time taken 11.080639 iter 6 next_points [{'alpha': 0.08293024798070268, 'batch_size': 27, 'beta_1': 0.8749703991299163, 'beta_2': 0.9999957698618165, 'epsilon': 2.5973492530797954e-09, 'hidden_layer_sizes': 83, 'learning_rate_init': 8.347324699460227e-05, 'tol': 3.880058680757336e-05, 'validation_fraction': 0.16421920321819616}]
function_evaluation time 0.102113 value 16.079543 suggestion {'alpha': 0.08293024798070268, 'batch_size': 27, 'beta_1': 0.8749703991299163, 'beta_2': 0.9999957698618165, 'epsilon': 2.5973492530797954e-09, 'hidden_layer_sizes': 83, 'learning_rate_init': 8.347324699460227e-05, 'tol': 3.880058680757336e-05, 'validation_fraction': 0.16421920321819616}
observation time 0.000007, current best 0.945916 at iter 6
suggestion time taken 10.846357 iter 7 next_points [{'alpha': 0.42825312788689923, 'batch_size': 22, 'beta_1': 0.8591725793796549, 'beta_2': 0.9999932070995177, 'epsilon': 4.346088268652914e-07, 'hidden_layer_sizes': 151, 'learning_rate_init': 0.04746972569203614, 'tol': 0.0030411151492971866, 'validation_fraction': 0.6768356561176622}]
function_evaluation time 0.187203 value 2.654326 suggestion {'alpha': 0.42825312788689923, 'batch_size': 22, 'beta_1': 0.8591725793796549, 'beta_2': 0.9999932070995177, 'epsilon': 4.346088268652914e-07, 'hidden_layer_sizes': 151, 'learning_rate_init': 0.04746972569203614, 'tol': 0.0030411151492971866, 'validation_fraction': 0.6768356561176622}
observation time 0.000006, current best 0.945916 at iter 7
suggestion time taken 10.770110 iter 8 next_points [{'alpha': 2.0864731421715943, 'batch_size': 11, 'beta_1': 0.7982812598668179, 'beta_2': 0.9981307932113809, 'epsilon': 6.763661890510683e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.00045174760813716596, 'tol': 0.01096667606802354, 'validation_fraction': 0.4994877872571178}]
function_evaluation time 0.272528 value 3.071263 suggestion {'alpha': 2.0864731421715943, 'batch_size': 11, 'beta_1': 0.7982812598668179, 'beta_2': 0.9981307932113809, 'epsilon': 6.763661890510683e-08, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.00045174760813716596, 'tol': 0.01096667606802354, 'validation_fraction': 0.4994877872571178}
observation time 0.000006, current best 0.945916 at iter 8
suggestion time taken 11.047599 iter 9 next_points [{'alpha': 0.006031852168723341, 'batch_size': 16, 'beta_1': 0.5568718796549122, 'beta_2': 0.9457600042330312, 'epsilon': 1.9434820903798912e-08, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.00010200969133736017, 'tol': 4.539109975513053e-05, 'validation_fraction': 0.4576101704813514}]
function_evaluation time 0.093781 value 20.333683 suggestion {'alpha': 0.006031852168723341, 'batch_size': 16, 'beta_1': 0.5568718796549122, 'beta_2': 0.9457600042330312, 'epsilon': 1.9434820903798912e-08, 'hidden_layer_sizes': 125, 'learning_rate_init': 0.00010200969133736017, 'tol': 4.539109975513053e-05, 'validation_fraction': 0.4576101704813514}
observation time 0.000009, current best 0.945916 at iter 9
suggestion time taken 10.823177 iter 10 next_points [{'alpha': 5.730282805748526, 'batch_size': 20, 'beta_1': 0.979895853393267, 'beta_2': 0.9999013005677312, 'epsilon': 2.927018119020664e-07, 'hidden_layer_sizes': 195, 'learning_rate_init': 0.00011190562617285029, 'tol': 0.0032673171037498824, 'validation_fraction': 0.7332773379254178}]
function_evaluation time 0.085795 value 20.400446 suggestion {'alpha': 5.730282805748526, 'batch_size': 20, 'beta_1': 0.979895853393267, 'beta_2': 0.9999013005677312, 'epsilon': 2.927018119020664e-07, 'hidden_layer_sizes': 195, 'learning_rate_init': 0.00011190562617285029, 'tol': 0.0032673171037498824, 'validation_fraction': 0.7332773379254178}
observation time 0.000004, current best 0.945916 at iter 10
suggestion time taken 10.717366 iter 11 next_points [{'alpha': 5.0021956036417486e-05, 'batch_size': 31, 'beta_1': 0.9711244076914576, 'beta_2': 0.9999988625131824, 'epsilon': 7.910984327023351e-09, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.0002986114796654021, 'tol': 1.2351592842299297e-05, 'validation_fraction': 0.5757642134012197}]
function_evaluation time 0.120539 value 14.857404 suggestion {'alpha': 5.0021956036417486e-05, 'batch_size': 31, 'beta_1': 0.9711244076914576, 'beta_2': 0.9999988625131824, 'epsilon': 7.910984327023351e-09, 'hidden_layer_sizes': 196, 'learning_rate_init': 0.0002986114796654021, 'tol': 1.2351592842299297e-05, 'validation_fraction': 0.5757642134012197}
observation time 0.000006, current best 0.945916 at iter 11
suggestion time taken 11.044618 iter 12 next_points [{'alpha': 0.00024860265838959176, 'batch_size': 11, 'beta_1': 0.9890880648385819, 'beta_2': 0.9987228277835566, 'epsilon': 4.096899397430156e-07, 'hidden_layer_sizes': 138, 'learning_rate_init': 0.000828005727182391, 'tol': 1.5750660591046687e-05, 'validation_fraction': 0.2659392958971604}]
function_evaluation time 0.301943 value 1.914722 suggestion {'alpha': 0.00024860265838959176, 'batch_size': 11, 'beta_1': 0.9890880648385819, 'beta_2': 0.9987228277835566, 'epsilon': 4.096899397430156e-07, 'hidden_layer_sizes': 138, 'learning_rate_init': 0.000828005727182391, 'tol': 1.5750660591046687e-05, 'validation_fraction': 0.2659392958971604}
observation time 0.000005, current best 0.945916 at iter 12
suggestion time taken 10.837377 iter 13 next_points [{'alpha': 0.00018518959503095056, 'batch_size': 12, 'beta_1': 0.9291802252361393, 'beta_2': 0.9997111149747262, 'epsilon': 4.6552129161991607e-07, 'hidden_layer_sizes': 161, 'learning_rate_init': 0.009928299279282293, 'tol': 0.05639022888065616, 'validation_fraction': 0.8042700848442342}]
function_evaluation time 0.129250 value 2.712073 suggestion {'alpha': 0.00018518959503095056, 'batch_size': 12, 'beta_1': 0.9291802252361393, 'beta_2': 0.9997111149747262, 'epsilon': 4.6552129161991607e-07, 'hidden_layer_sizes': 161, 'learning_rate_init': 0.009928299279282293, 'tol': 0.05639022888065616, 'validation_fraction': 0.8042700848442342}
observation time 0.000005, current best 0.945916 at iter 13
suggestion time taken 10.894862 iter 14 next_points [{'alpha': 0.0023963455321525566, 'batch_size': 11, 'beta_1': 0.9423786381546392, 'beta_2': 0.9831411335920665, 'epsilon': 4.8381370281601404e-08, 'hidden_layer_sizes': 172, 'learning_rate_init': 0.00025076052858636667, 'tol': 0.0026340352454848554, 'validation_fraction': 0.5484572203840239}]
function_evaluation time 0.215988 value 9.786157 suggestion {'alpha': 0.0023963455321525566, 'batch_size': 11, 'beta_1': 0.9423786381546392, 'beta_2': 0.9831411335920665, 'epsilon': 4.8381370281601404e-08, 'hidden_layer_sizes': 172, 'learning_rate_init': 0.00025076052858636667, 'tol': 0.0026340352454848554, 'validation_fraction': 0.5484572203840239}
observation time 0.000006, current best 0.945916 at iter 14
saving meta data: {'args': {'--uuid': '4f715ec8622750f88ae70cb633900a59', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_224500', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])}
saving results
saving timing
saving suggest log
done
