running: {'--uuid': '2658c87e63bd5317919a003dd0f6efa0', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_224500', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d wine -o smoothness -u 2658c87e63bd5317919a003dd0f6efa0 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_224500
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_wine_nll betwen [15.51998549 22.35390307 19.16402613  3.37792524 14.64310022] and [16.06396227 23.27425025 19.80193088  3.46391821 15.2105797 ]
  warnings.warn(

Signature errors:
                          0         1         2         3         4       max
MLP-adam_wine_nll  0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
max                0.543977  0.920347  0.637905  0.085993  0.567479  0.920347
starting sklearn study smoothness MLP-adam wine nll 15 1
with data root: None
suggestion time taken 10.942538 iter 0 next_points [{'alpha': 0.001631255838542562, 'batch_size': 35, 'beta_1': 0.9688489597669685, 'beta_2': 0.999971699103302, 'epsilon': 2.6000890526037846e-09, 'hidden_layer_sizes': 116, 'learning_rate_init': 1.1607904358385273e-05, 'tol': 0.00010530775374319637, 'validation_fraction': 0.5633253284507853}]
function_evaluation time 0.060371 value 23.413727 suggestion {'alpha': 0.001631255838542562, 'batch_size': 35, 'beta_1': 0.9688489597669685, 'beta_2': 0.999971699103302, 'epsilon': 2.6000890526037846e-09, 'hidden_layer_sizes': 116, 'learning_rate_init': 1.1607904358385273e-05, 'tol': 0.00010530775374319637, 'validation_fraction': 0.5633253284507853}
observation time 0.000006, current best 23.413727 at iter 0
suggestion time taken 11.062379 iter 1 next_points [{'alpha': 0.0006232948202336408, 'batch_size': 19, 'beta_1': 0.5021303311302084, 'beta_2': 0.9998943752271754, 'epsilon': 8.920033024812725e-08, 'hidden_layer_sizes': 175, 'learning_rate_init': 0.0007227210895934233, 'tol': 0.0006441406846947325, 'validation_fraction': 0.4735306918754508}]
function_evaluation time 0.215800 value 3.155236 suggestion {'alpha': 0.0006232948202336408, 'batch_size': 19, 'beta_1': 0.5021303311302084, 'beta_2': 0.9998943752271754, 'epsilon': 8.920033024812725e-08, 'hidden_layer_sizes': 175, 'learning_rate_init': 0.0007227210895934233, 'tol': 0.0006441406846947325, 'validation_fraction': 0.4735306918754508}
observation time 0.000006, current best 3.155236 at iter 1
suggestion time taken 10.817419 iter 2 next_points [{'alpha': 2.7900961284990276, 'batch_size': 49, 'beta_1': 0.7225241558974139, 'beta_2': 0.9999530402583757, 'epsilon': 1.1774333317545325e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.00025052438715186657, 'tol': 0.0002757831154067732, 'validation_fraction': 0.6838043483544349}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.071939 value 17.265311 suggestion {'alpha': 2.7900961284990276, 'batch_size': 49, 'beta_1': 0.7225241558974139, 'beta_2': 0.9999530402583757, 'epsilon': 1.1774333317545325e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.00025052438715186657, 'tol': 0.0002757831154067732, 'validation_fraction': 0.6838043483544349}
observation time 0.000005, current best 3.155236 at iter 2
suggestion time taken 11.126496 iter 3 next_points [{'alpha': 0.0314407020737066, 'batch_size': 11, 'beta_1': 0.9340867790329103, 'beta_2': 0.9996813864673589, 'epsilon': 1.861222723340071e-08, 'hidden_layer_sizes': 178, 'learning_rate_init': 3.0260628726484725e-05, 'tol': 0.00025366343798200754, 'validation_fraction': 0.10841754889080567}]
function_evaluation time 0.289461 value 11.395971 suggestion {'alpha': 0.0314407020737066, 'batch_size': 11, 'beta_1': 0.9340867790329103, 'beta_2': 0.9996813864673589, 'epsilon': 1.861222723340071e-08, 'hidden_layer_sizes': 178, 'learning_rate_init': 3.0260628726484725e-05, 'tol': 0.00025366343798200754, 'validation_fraction': 0.10841754889080567}
observation time 0.000005, current best 3.155236 at iter 3
suggestion time taken 10.753078 iter 4 next_points [{'alpha': 4.504119106862747e-05, 'batch_size': 19, 'beta_1': 0.8313777711487595, 'beta_2': 0.9999167111347274, 'epsilon': 9.16566958659693e-08, 'hidden_layer_sizes': 162, 'learning_rate_init': 0.0027135779955940005, 'tol': 0.00010893655203876751, 'validation_fraction': 0.6915105631929475}]
function_evaluation time 0.165712 value 0.606686 suggestion {'alpha': 4.504119106862747e-05, 'batch_size': 19, 'beta_1': 0.8313777711487595, 'beta_2': 0.9999167111347274, 'epsilon': 9.16566958659693e-08, 'hidden_layer_sizes': 162, 'learning_rate_init': 0.0027135779955940005, 'tol': 0.00010893655203876751, 'validation_fraction': 0.6915105631929475}
observation time 0.000005, current best 0.606686 at iter 4
suggestion time taken 10.768891 iter 5 next_points [{'alpha': 0.25196799338261805, 'batch_size': 17, 'beta_1': 0.9725246685147655, 'beta_2': 0.9986281746381488, 'epsilon': 4.970782330097352e-07, 'hidden_layer_sizes': 125, 'learning_rate_init': 1.450508424211922e-05, 'tol': 0.03604586944070499, 'validation_fraction': 0.4167269405512178}]
function_evaluation time 0.081527 value 21.948981 suggestion {'alpha': 0.25196799338261805, 'batch_size': 17, 'beta_1': 0.9725246685147655, 'beta_2': 0.9986281746381488, 'epsilon': 4.970782330097352e-07, 'hidden_layer_sizes': 125, 'learning_rate_init': 1.450508424211922e-05, 'tol': 0.03604586944070499, 'validation_fraction': 0.4167269405512178}
observation time 0.000006, current best 0.606686 at iter 5
suggestion time taken 11.113389 iter 6 next_points [{'alpha': 1.8003224604692423e-05, 'batch_size': 11, 'beta_1': 0.985252829705096, 'beta_2': 0.9999844381981142, 'epsilon': 4.396811130808969e-07, 'hidden_layer_sizes': 124, 'learning_rate_init': 2.459557591937289e-05, 'tol': 9.630687915152261e-05, 'validation_fraction': 0.7886688290597357}]
function_evaluation time 0.083935 value 18.670349 suggestion {'alpha': 1.8003224604692423e-05, 'batch_size': 11, 'beta_1': 0.985252829705096, 'beta_2': 0.9999844381981142, 'epsilon': 4.396811130808969e-07, 'hidden_layer_sizes': 124, 'learning_rate_init': 2.459557591937289e-05, 'tol': 9.630687915152261e-05, 'validation_fraction': 0.7886688290597357}
observation time 0.000006, current best 0.606686 at iter 6
suggestion time taken 10.804331 iter 7 next_points [{'alpha': 0.0022349756452830914, 'batch_size': 16, 'beta_1': 0.7482188551649414, 'beta_2': 0.9998534299715168, 'epsilon': 1.4448337551489017e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.0005247808188872448, 'tol': 0.031062509033866013, 'validation_fraction': 0.14054259494518936}]
function_evaluation time 0.224693 value 1.355416 suggestion {'alpha': 0.0022349756452830914, 'batch_size': 16, 'beta_1': 0.7482188551649414, 'beta_2': 0.9998534299715168, 'epsilon': 1.4448337551489017e-08, 'hidden_layer_sizes': 70, 'learning_rate_init': 0.0005247808188872448, 'tol': 0.031062509033866013, 'validation_fraction': 0.14054259494518936}
observation time 0.000005, current best 0.606686 at iter 7
suggestion time taken 10.832291 iter 8 next_points [{'alpha': 2.8431103894677614, 'batch_size': 16, 'beta_1': 0.8559905599183106, 'beta_2': 0.9999796146378453, 'epsilon': 1.2010375123803782e-08, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.0029917715003567546, 'tol': 0.008080253250712722, 'validation_fraction': 0.11570272898907562}]
function_evaluation time 0.206169 value 0.858390 suggestion {'alpha': 2.8431103894677614, 'batch_size': 16, 'beta_1': 0.8559905599183106, 'beta_2': 0.9999796146378453, 'epsilon': 1.2010375123803782e-08, 'hidden_layer_sizes': 99, 'learning_rate_init': 0.0029917715003567546, 'tol': 0.008080253250712722, 'validation_fraction': 0.11570272898907562}
observation time 0.000005, current best 0.606686 at iter 8
suggestion time taken 11.074735 iter 9 next_points [{'alpha': 0.0004429622722944752, 'batch_size': 22, 'beta_1': 0.7918779377676529, 'beta_2': 0.9996831751833444, 'epsilon': 7.986526731505327e-08, 'hidden_layer_sizes': 97, 'learning_rate_init': 3.429984962473511e-05, 'tol': 0.0010341925767709858, 'validation_fraction': 0.8018537560389116}]
function_evaluation time 0.049553 value 23.105467 suggestion {'alpha': 0.0004429622722944752, 'batch_size': 22, 'beta_1': 0.7918779377676529, 'beta_2': 0.9996831751833444, 'epsilon': 7.986526731505327e-08, 'hidden_layer_sizes': 97, 'learning_rate_init': 3.429984962473511e-05, 'tol': 0.0010341925767709858, 'validation_fraction': 0.8018537560389116}
observation time 0.000005, current best 0.606686 at iter 9
suggestion time taken 10.806813 iter 10 next_points [{'alpha': 0.0002815518653873117, 'batch_size': 25, 'beta_1': 0.9799970371362765, 'beta_2': 0.9870938893217597, 'epsilon': 9.27173436433881e-08, 'hidden_layer_sizes': 126, 'learning_rate_init': 8.850224966470575e-05, 'tol': 0.0008097965418518746, 'validation_fraction': 0.5517746505451483}]
function_evaluation time 0.081009 value 16.556164 suggestion {'alpha': 0.0002815518653873117, 'batch_size': 25, 'beta_1': 0.9799970371362765, 'beta_2': 0.9870938893217597, 'epsilon': 9.27173436433881e-08, 'hidden_layer_sizes': 126, 'learning_rate_init': 8.850224966470575e-05, 'tol': 0.0008097965418518746, 'validation_fraction': 0.5517746505451483}
observation time 0.000005, current best 0.606686 at iter 10
suggestion time taken 10.761879 iter 11 next_points [{'alpha': 0.0006359329325433003, 'batch_size': 20, 'beta_1': 0.9820535923015093, 'beta_2': 0.9999685484220286, 'epsilon': 2.1695923476564907e-09, 'hidden_layer_sizes': 65, 'learning_rate_init': 0.00011690414917305437, 'tol': 0.014968190702489975, 'validation_fraction': 0.6547839176137046}]
function_evaluation time 0.065548 value 24.138594 suggestion {'alpha': 0.0006359329325433003, 'batch_size': 20, 'beta_1': 0.9820535923015093, 'beta_2': 0.9999685484220286, 'epsilon': 2.1695923476564907e-09, 'hidden_layer_sizes': 65, 'learning_rate_init': 0.00011690414917305437, 'tol': 0.014968190702489975, 'validation_fraction': 0.6547839176137046}
observation time 0.000005, current best 0.606686 at iter 11
suggestion time taken 10.833174 iter 12 next_points [{'alpha': 3.039413608193287e-05, 'batch_size': 22, 'beta_1': 0.9643775067931307, 'beta_2': 0.9136198298852757, 'epsilon': 1.2928237137710841e-08, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.0034357694498712847, 'tol': 0.0007605602717512274, 'validation_fraction': 0.757662043293954}]
function_evaluation time 0.132761 value 5.515360 suggestion {'alpha': 3.039413608193287e-05, 'batch_size': 22, 'beta_1': 0.9643775067931307, 'beta_2': 0.9136198298852757, 'epsilon': 1.2928237137710841e-08, 'hidden_layer_sizes': 110, 'learning_rate_init': 0.0034357694498712847, 'tol': 0.0007605602717512274, 'validation_fraction': 0.757662043293954}
observation time 0.000005, current best 0.606686 at iter 12
suggestion time taken 11.112711 iter 13 next_points [{'alpha': 3.802315562785827e-05, 'batch_size': 27, 'beta_1': 0.9679431497989119, 'beta_2': 0.9694694847663435, 'epsilon': 5.435326730748403e-07, 'hidden_layer_sizes': 141, 'learning_rate_init': 0.04441158275164306, 'tol': 0.07020856339176924, 'validation_fraction': 0.32294895858025835}]
function_evaluation time 0.102662 value 0.968537 suggestion {'alpha': 3.802315562785827e-05, 'batch_size': 27, 'beta_1': 0.9679431497989119, 'beta_2': 0.9694694847663435, 'epsilon': 5.435326730748403e-07, 'hidden_layer_sizes': 141, 'learning_rate_init': 0.04441158275164306, 'tol': 0.07020856339176924, 'validation_fraction': 0.32294895858025835}
observation time 0.000005, current best 0.606686 at iter 13
suggestion time taken 10.881138 iter 14 next_points [{'alpha': 1.9821198412687058, 'batch_size': 18, 'beta_1': 0.9551212697905899, 'beta_2': 0.9864023354737841, 'epsilon': 1.0487348419961961e-08, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.0021640523791070856, 'tol': 0.0001451204973383283, 'validation_fraction': 0.21727319629441122}]
function_evaluation time 0.201780 value 8.715082 suggestion {'alpha': 1.9821198412687058, 'batch_size': 18, 'beta_1': 0.9551212697905899, 'beta_2': 0.9864023354737841, 'epsilon': 1.0487348419961961e-08, 'hidden_layer_sizes': 55, 'learning_rate_init': 0.0021640523791070856, 'tol': 0.0001451204973383283, 'validation_fraction': 0.21727319629441122}
observation time 0.000005, current best 0.606686 at iter 14
saving meta data: {'args': {'--uuid': '2658c87e63bd5317919a003dd0f6efa0', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_224500', '--opt': 'smoothness', '--data': 'wine', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [16.063962273407764, 23.274250254613083, 19.80193088400322, 3.463918210725012, 15.210579700922176])}
saving results
saving timing
saving suggest log
done
