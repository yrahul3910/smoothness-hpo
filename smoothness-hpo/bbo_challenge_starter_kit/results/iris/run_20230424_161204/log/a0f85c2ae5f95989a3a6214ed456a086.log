running: {'--uuid': 'a0f85c2ae5f95989a3a6214ed456a086', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_161204', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}
cmd: python smoothness/optimizer.py -c MLP-adam -d iris -o smoothness -u a0f85c2ae5f95989a3a6214ed456a086 -m nll -n 15 -p 1 -dir /home/ryedida/bbo_challenge_starter_kit/output -b run_20230424_161204
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

computed signature: ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])
/home/ryedida/.local/lib/python3.9/site-packages/bayesmark/signatures.py:85: RuntimeWarning: Signature diverged on MLP-adam_iris_nll betwen [1.31057198 1.56976556 1.25224472 0.90978049 0.39813052] and [1.32439241 1.77609477 1.43221076 0.9966468  0.57459871]
  warnings.warn(

Signature errors:
                         0         1         2         3         4       max
MLP-adam_iris_nll  0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
max                0.01382  0.206329  0.179966  0.086866  0.176468  0.206329
starting sklearn study smoothness MLP-adam iris nll 15 1
with data root: None
suggestion time taken 10.883417 iter 0 next_points [{'alpha': 6.848145984426676e-05, 'batch_size': 15, 'beta_1': 0.9744082643054529, 'beta_2': 0.9959858591277095, 'epsilon': 2.3921883467744255e-07, 'hidden_layer_sizes': 152, 'learning_rate_init': 0.0006417501916040551, 'tol': 1.2285083053260162e-05, 'validation_fraction': 0.3041359328120133}]
function_evaluation time 0.165514 value 0.793537 suggestion {'alpha': 6.848145984426676e-05, 'batch_size': 15, 'beta_1': 0.9744082643054529, 'beta_2': 0.9959858591277095, 'epsilon': 2.3921883467744255e-07, 'hidden_layer_sizes': 152, 'learning_rate_init': 0.0006417501916040551, 'tol': 1.2285083053260162e-05, 'validation_fraction': 0.3041359328120133}
observation time 0.000006, current best 0.793537 at iter 0
suggestion time taken 11.041346 iter 1 next_points [{'alpha': 0.0022951596772565973, 'batch_size': 25, 'beta_1': 0.5233830429792918, 'beta_2': 0.9999986133034549, 'epsilon': 4.917494365589307e-09, 'hidden_layer_sizes': 142, 'learning_rate_init': 0.007787644644146209, 'tol': 0.0001693231030596691, 'validation_fraction': 0.5936159931144143}]
function_evaluation time 0.096602 value 0.389741 suggestion {'alpha': 0.0022951596772565973, 'batch_size': 25, 'beta_1': 0.5233830429792918, 'beta_2': 0.9999986133034549, 'epsilon': 4.917494365589307e-09, 'hidden_layer_sizes': 142, 'learning_rate_init': 0.007787644644146209, 'tol': 0.0001693231030596691, 'validation_fraction': 0.5936159931144143}
observation time 0.000005, current best 0.389741 at iter 1
suggestion time taken 10.733486 iter 2 next_points [{'alpha': 1.432068761495465, 'batch_size': 21, 'beta_1': 0.8122377266746519, 'beta_2': 0.9994721769909692, 'epsilon': 6.159640282896047e-09, 'hidden_layer_sizes': 71, 'learning_rate_init': 0.0026275038436795175, 'tol': 0.01533029157556339, 'validation_fraction': 0.10148884213165717}]
function_evaluation time 0.141500 value 0.714963 suggestion {'alpha': 1.432068761495465, 'batch_size': 21, 'beta_1': 0.8122377266746519, 'beta_2': 0.9994721769909692, 'epsilon': 6.159640282896047e-09, 'hidden_layer_sizes': 71, 'learning_rate_init': 0.0026275038436795175, 'tol': 0.01533029157556339, 'validation_fraction': 0.10148884213165717}
observation time 0.000006, current best 0.389741 at iter 2
suggestion time taken 11.041274 iter 3 next_points [{'alpha': 0.0002731604604202952, 'batch_size': 14, 'beta_1': 0.8154597005961355, 'beta_2': 0.9999983137493479, 'epsilon': 6.325784688769768e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 1.806634304579395e-05, 'tol': 1.0049892757080564e-05, 'validation_fraction': 0.11207602721726434}]
function_evaluation time 0.126036 value 1.836041 suggestion {'alpha': 0.0002731604604202952, 'batch_size': 14, 'beta_1': 0.8154597005961355, 'beta_2': 0.9999983137493479, 'epsilon': 6.325784688769768e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 1.806634304579395e-05, 'tol': 1.0049892757080564e-05, 'validation_fraction': 0.11207602721726434}
observation time 0.000005, current best 0.389741 at iter 3
suggestion time taken 10.806481 iter 4 next_points [{'alpha': 2.6831519609832698e-05, 'batch_size': 18, 'beta_1': 0.9891774019325226, 'beta_2': 0.9996388762664874, 'epsilon': 1.266990574990687e-09, 'hidden_layer_sizes': 184, 'learning_rate_init': 1.192897923424617e-05, 'tol': 0.019585316926232627, 'validation_fraction': 0.845158842170313}]
function_evaluation time 0.046148 value 1.430592 suggestion {'alpha': 2.6831519609832698e-05, 'batch_size': 18, 'beta_1': 0.9891774019325226, 'beta_2': 0.9996388762664874, 'epsilon': 1.266990574990687e-09, 'hidden_layer_sizes': 184, 'learning_rate_init': 1.192897923424617e-05, 'tol': 0.019585316926232627, 'validation_fraction': 0.845158842170313}
observation time 0.000005, current best 0.389741 at iter 4
suggestion time taken 10.733412 iter 5 next_points [{'alpha': 0.009695128561667756, 'batch_size': 18, 'beta_1': 0.9771421221313019, 'beta_2': 0.9999977940692164, 'epsilon': 7.733185991067687e-07, 'hidden_layer_sizes': 109, 'learning_rate_init': 0.000201235264826868, 'tol': 0.0022602060028557983, 'validation_fraction': 0.4098820213143997}]
function_evaluation time 0.100707 value 1.219847 suggestion {'alpha': 0.009695128561667756, 'batch_size': 18, 'beta_1': 0.9771421221313019, 'beta_2': 0.9999977940692164, 'epsilon': 7.733185991067687e-07, 'hidden_layer_sizes': 109, 'learning_rate_init': 0.000201235264826868, 'tol': 0.0022602060028557983, 'validation_fraction': 0.4098820213143997}
observation time 0.000006, current best 0.389741 at iter 5
suggestion time taken 11.055469 iter 6 next_points [{'alpha': 0.7085891285393285, 'batch_size': 11, 'beta_1': 0.9639517418834332, 'beta_2': 0.9970771227781206, 'epsilon': 3.215398835495744e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.01882885398855577, 'tol': 1.2784430283936999e-05, 'validation_fraction': 0.6165148172061027}]
function_evaluation time 0.113459 value 0.400198 suggestion {'alpha': 0.7085891285393285, 'batch_size': 11, 'beta_1': 0.9639517418834332, 'beta_2': 0.9970771227781206, 'epsilon': 3.215398835495744e-07, 'hidden_layer_sizes': 85, 'learning_rate_init': 0.01882885398855577, 'tol': 1.2784430283936999e-05, 'validation_fraction': 0.6165148172061027}
observation time 0.000005, current best 0.389741 at iter 6
suggestion time taken 10.799455 iter 7 next_points [{'alpha': 0.03250832196962595, 'batch_size': 13, 'beta_1': 0.9130535694251268, 'beta_2': 0.9999874397104408, 'epsilon': 1.05187856874017e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.006709829969885479, 'tol': 1.6941240837692548e-05, 'validation_fraction': 0.8940162521036855}]
/home/ryedida/.local/lib/python3.9/site-packages/sklearn/neural_network/_multilayer_perceptron.py:605: UserWarning: Got `batch_size` less than 1 or larger than sample size. It is going to be clipped
  warnings.warn(

function_evaluation time 0.090662 value 0.669562 suggestion {'alpha': 0.03250832196962595, 'batch_size': 13, 'beta_1': 0.9130535694251268, 'beta_2': 0.9999874397104408, 'epsilon': 1.05187856874017e-09, 'hidden_layer_sizes': 76, 'learning_rate_init': 0.006709829969885479, 'tol': 1.6941240837692548e-05, 'validation_fraction': 0.8940162521036855}
observation time 0.000006, current best 0.389741 at iter 7
suggestion time taken 10.769470 iter 8 next_points [{'alpha': 0.41136891493057953, 'batch_size': 27, 'beta_1': 0.9843487856378232, 'beta_2': 0.9999969216638833, 'epsilon': 3.1572422770194982e-09, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.00023464192549664417, 'tol': 0.0661119124464312, 'validation_fraction': 0.7446402049523204}]
function_evaluation time 0.045110 value 1.526778 suggestion {'alpha': 0.41136891493057953, 'batch_size': 27, 'beta_1': 0.9843487856378232, 'beta_2': 0.9999969216638833, 'epsilon': 3.1572422770194982e-09, 'hidden_layer_sizes': 95, 'learning_rate_init': 0.00023464192549664417, 'tol': 0.0661119124464312, 'validation_fraction': 0.7446402049523204}
observation time 0.000005, current best 0.389741 at iter 8
suggestion time taken 11.008484 iter 9 next_points [{'alpha': 0.052052664706341005, 'batch_size': 17, 'beta_1': 0.6209443891136779, 'beta_2': 0.9748897002060698, 'epsilon': 2.6878041757840164e-08, 'hidden_layer_sizes': 85, 'learning_rate_init': 5.9228957235769006e-05, 'tol': 0.05038587763691748, 'validation_fraction': 0.2331350140730882}]
function_evaluation time 0.095987 value 1.624806 suggestion {'alpha': 0.052052664706341005, 'batch_size': 17, 'beta_1': 0.6209443891136779, 'beta_2': 0.9748897002060698, 'epsilon': 2.6878041757840164e-08, 'hidden_layer_sizes': 85, 'learning_rate_init': 5.9228957235769006e-05, 'tol': 0.05038587763691748, 'validation_fraction': 0.2331350140730882}
observation time 0.000005, current best 0.389741 at iter 9
suggestion time taken 10.840099 iter 10 next_points [{'alpha': 0.0027059720614470073, 'batch_size': 11, 'beta_1': 0.9008625021674311, 'beta_2': 0.9844175737897652, 'epsilon': 3.1831650034587035e-09, 'hidden_layer_sizes': 179, 'learning_rate_init': 0.018514427456196653, 'tol': 0.00018587546632524334, 'validation_fraction': 0.8388250249129828}]
function_evaluation time 0.114253 value 0.281079 suggestion {'alpha': 0.0027059720614470073, 'batch_size': 11, 'beta_1': 0.9008625021674311, 'beta_2': 0.9844175737897652, 'epsilon': 3.1831650034587035e-09, 'hidden_layer_sizes': 179, 'learning_rate_init': 0.018514427456196653, 'tol': 0.00018587546632524334, 'validation_fraction': 0.8388250249129828}
observation time 0.000005, current best 0.281079 at iter 10
suggestion time taken 10.797735 iter 11 next_points [{'alpha': 1.1219510936435834e-05, 'batch_size': 19, 'beta_1': 0.941442842513118, 'beta_2': 0.9999977853180296, 'epsilon': 4.797353388412636e-09, 'hidden_layer_sizes': 183, 'learning_rate_init': 0.00012131128748551107, 'tol': 0.00029018489758185154, 'validation_fraction': 0.33485689321501527}]
function_evaluation time 0.110285 value 1.035102 suggestion {'alpha': 1.1219510936435834e-05, 'batch_size': 19, 'beta_1': 0.941442842513118, 'beta_2': 0.9999977853180296, 'epsilon': 4.797353388412636e-09, 'hidden_layer_sizes': 183, 'learning_rate_init': 0.00012131128748551107, 'tol': 0.00029018489758185154, 'validation_fraction': 0.33485689321501527}
observation time 0.000005, current best 0.281079 at iter 11
suggestion time taken 10.761706 iter 12 next_points [{'alpha': 0.00016224796509799546, 'batch_size': 14, 'beta_1': 0.7513207505037652, 'beta_2': 0.9923375230845132, 'epsilon': 1.6288491410792673e-08, 'hidden_layer_sizes': 158, 'learning_rate_init': 0.001580306988283199, 'tol': 0.004109007732341242, 'validation_fraction': 0.7388988456130882}]
function_evaluation time 0.119579 value 0.731247 suggestion {'alpha': 0.00016224796509799546, 'batch_size': 14, 'beta_1': 0.7513207505037652, 'beta_2': 0.9923375230845132, 'epsilon': 1.6288491410792673e-08, 'hidden_layer_sizes': 158, 'learning_rate_init': 0.001580306988283199, 'tol': 0.004109007732341242, 'validation_fraction': 0.7388988456130882}
observation time 0.000006, current best 0.281079 at iter 12
suggestion time taken 11.033689 iter 13 next_points [{'alpha': 9.882507807331011, 'batch_size': 18, 'beta_1': 0.5324999035963195, 'beta_2': 0.9203302561650701, 'epsilon': 1.96917809229424e-07, 'hidden_layer_sizes': 127, 'learning_rate_init': 0.0007749368708940361, 'tol': 0.00011335924853105123, 'validation_fraction': 0.29773662804453327}]
function_evaluation time 0.120855 value 0.912752 suggestion {'alpha': 9.882507807331011, 'batch_size': 18, 'beta_1': 0.5324999035963195, 'beta_2': 0.9203302561650701, 'epsilon': 1.96917809229424e-07, 'hidden_layer_sizes': 127, 'learning_rate_init': 0.0007749368708940361, 'tol': 0.00011335924853105123, 'validation_fraction': 0.29773662804453327}
observation time 0.000007, current best 0.281079 at iter 13
suggestion time taken 10.813011 iter 14 next_points [{'alpha': 0.047236833715034184, 'batch_size': 21, 'beta_1': 0.6448104339780633, 'beta_2': 0.9998842274246865, 'epsilon': 5.940968132391019e-09, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.0027333023943027224, 'tol': 2.3798742300460636e-05, 'validation_fraction': 0.10558460925598784}]
function_evaluation time 0.120937 value 0.766719 suggestion {'alpha': 0.047236833715034184, 'batch_size': 21, 'beta_1': 0.6448104339780633, 'beta_2': 0.9998842274246865, 'epsilon': 5.940968132391019e-09, 'hidden_layer_sizes': 60, 'learning_rate_init': 0.0027333023943027224, 'tol': 2.3798742300460636e-05, 'validation_fraction': 0.10558460925598784}
observation time 0.000005, current best 0.281079 at iter 14
saving meta data: {'args': {'--uuid': 'a0f85c2ae5f95989a3a6214ed456a086', '-db-root': '/home/ryedida/bbo_challenge_starter_kit/output', '--opt-root': '/home/ryedida/bbo_challenge_starter_kit/example_submissions', '--data-root': None, '--db': 'run_20230424_161204', '--opt': 'smoothness', '--data': 'iris', '--classifier': 'MLP-adam', '--metric': 'nll', '--calls': 15, '--suggestions': 1, '--jobs-file': None, '--verbose': False, 'dry_run': False, 'rev': 'a376313', 'opt_rev': 'x.x.x'}, 'signature': ([{'alpha': 0.019628224813442792, 'batch_size': 182, 'beta_1': 0.9410202200271762, 'beta_2': 0.9998021557676793, 'epsilon': 1.8662266976518e-08, 'hidden_layer_sizes': 147, 'learning_rate_init': 0.0005627932047415167, 'tol': 0.03690557729213761, 'validation_fraction': 0.8846827852548593}, {'alpha': 0.0019982467392329444, 'batch_size': 200, 'beta_1': 0.919111482530466, 'beta_2': 0.9998488260436156, 'epsilon': 5.981221901152555e-07, 'hidden_layer_sizes': 61, 'learning_rate_init': 2.2310905607443014e-05, 'tol': 1.2046852412030316e-05, 'validation_fraction': 0.8117896445826539}, {'alpha': 0.46659545670218433, 'batch_size': 219, 'beta_1': 0.9889789783750891, 'beta_2': 0.9999896868093284, 'epsilon': 2.4234724484675948e-08, 'hidden_layer_sizes': 167, 'learning_rate_init': 2.972334644335654e-05, 'tol': 0.0036281404040243792, 'validation_fraction': 0.17260651658522078}, {'alpha': 4.656005689076002, 'batch_size': 135, 'beta_1': 0.870503881627747, 'beta_2': 0.9948873266941017, 'epsilon': 2.1023308743480125e-07, 'hidden_layer_sizes': 118, 'learning_rate_init': 0.0018781738757161913, 'tol': 1.1889379831773004e-05, 'validation_fraction': 0.6264327093752792}, {'alpha': 0.04705159350400542, 'batch_size': 158, 'beta_1': 0.9870884262730957, 'beta_2': 0.9999596874382349, 'epsilon': 1.1981845126013875e-08, 'hidden_layer_sizes': 116, 'learning_rate_init': 0.00617340520407431, 'tol': 1.741413418158619e-05, 'validation_fraction': 0.6754299026638921}], [1.3105719841770722, 1.7760947732249062, 1.4322107566090756, 0.9097804858215804, 0.5745987066718419])}
saving results
saving timing
saving suggest log
done
